<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>デスペめも | Note</title>
    <meta name="description" content="デスペめも">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css">
    
    <link rel="preload" href="/note/assets/css/0.styles.736745c0.css" as="style"><link rel="preload" href="/note/assets/js/app.7aa1caf6.js" as="script"><link rel="preload" href="/note/assets/js/15.54ea7ecb.js" as="script"><link rel="prefetch" href="/note/assets/js/10.b796bbe2.js"><link rel="prefetch" href="/note/assets/js/11.5e3ebc8c.js"><link rel="prefetch" href="/note/assets/js/12.e5411c30.js"><link rel="prefetch" href="/note/assets/js/13.6f007395.js"><link rel="prefetch" href="/note/assets/js/14.2b4b6958.js"><link rel="prefetch" href="/note/assets/js/16.5b070931.js"><link rel="prefetch" href="/note/assets/js/17.4b9ecc43.js"><link rel="prefetch" href="/note/assets/js/18.2ef58749.js"><link rel="prefetch" href="/note/assets/js/19.99c56935.js"><link rel="prefetch" href="/note/assets/js/2.6de73e29.js"><link rel="prefetch" href="/note/assets/js/20.91a272e5.js"><link rel="prefetch" href="/note/assets/js/21.daeeb1d8.js"><link rel="prefetch" href="/note/assets/js/22.b4bbc2c7.js"><link rel="prefetch" href="/note/assets/js/23.fb72eca9.js"><link rel="prefetch" href="/note/assets/js/24.a2e6b457.js"><link rel="prefetch" href="/note/assets/js/25.72d99469.js"><link rel="prefetch" href="/note/assets/js/26.9266d3f4.js"><link rel="prefetch" href="/note/assets/js/27.882e7fab.js"><link rel="prefetch" href="/note/assets/js/28.d3e27703.js"><link rel="prefetch" href="/note/assets/js/29.0ca74699.js"><link rel="prefetch" href="/note/assets/js/3.4ff442e6.js"><link rel="prefetch" href="/note/assets/js/30.bf2715a1.js"><link rel="prefetch" href="/note/assets/js/31.90f9812e.js"><link rel="prefetch" href="/note/assets/js/32.6e7b1a8c.js"><link rel="prefetch" href="/note/assets/js/33.9270e659.js"><link rel="prefetch" href="/note/assets/js/34.b25d4252.js"><link rel="prefetch" href="/note/assets/js/35.3092d896.js"><link rel="prefetch" href="/note/assets/js/4.6e90c8ad.js"><link rel="prefetch" href="/note/assets/js/5.c54a317b.js"><link rel="prefetch" href="/note/assets/js/6.58c36d29.js"><link rel="prefetch" href="/note/assets/js/7.503bb84d.js"><link rel="prefetch" href="/note/assets/js/8.416fa8b4.js"><link rel="prefetch" href="/note/assets/js/9.f38b3d15.js">
    <link rel="stylesheet" href="/note/assets/css/0.styles.736745c0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/note/" class="home-link router-link-active"><!----> <span class="site-name">Note</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/note/about.html" class="nav-link">About</a></div><div class="nav-item"><a href="/note/list.html" class="nav-link">Articles</a></div><div class="nav-item"><a href="/note/chukapi_fun_art.html" class="nav-link">Chukapi-Fun-Art</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/note/about.html" class="nav-link">About</a></div><div class="nav-item"><a href="/note/list.html" class="nav-link">Articles</a></div><div class="nav-item"><a href="/note/chukapi_fun_art.html" class="nav-link">Chukapi-Fun-Art</a></div> <!----></nav>  <!----> </div> <div class="page"> <div class="content"><h1 id="デスペめも"><a href="#デスペめも" aria-hidden="true" class="header-anchor">#</a> デスペめも</h1> <h1 id="_03-15"><a href="#_03-15" aria-hidden="true" class="header-anchor">#</a> 03/15</h1> <h1 id="_1章-sql"><a href="#_1章-sql" aria-hidden="true" class="header-anchor">#</a> 1章 SQL</h1> <h2 id="select"><a href="#select" aria-hidden="true" class="header-anchor">#</a> SELECT</h2> <ul><li>選択する句</li></ul> <h3 id="射影と選択"><a href="#射影と選択" aria-hidden="true" class="header-anchor">#</a> 射影と選択</h3> <ul><li>射影はcolumnを抜き出す
<ul><li>SELECT A1,A2,... FROM R</li></ul></li> <li>選択はrowを抜き出す
<ul><li>SELECT * FROM R WHERE X 比較演算子 Y</li></ul></li></ul> <h3 id="選択項目リスト"><a href="#選択項目リスト" aria-hidden="true" class="header-anchor">#</a> 選択項目リスト</h3> <ul><li>算術演算子
<ul><li>+,-.*,/を使用できる</li></ul></li> <li>連結演算子
<ul><li>||で要素を連結できる</li></ul></li> <li>別名(相関名)の指定
<ul><li>AS句は省略可能</li></ul></li> <li>重複の除去
<ul><li>SELECTの直後にDISTINCT句を入れる</li></ul></li> <li>NULL処理
<ul><li>COALESCE句を使用する</li> <li>isNotNull?(a:b)とCOALESCE (a,b)が同義</li></ul></li> <li>条件式(CASE文)
<ul><li>CASE WHEN 条件式 THEN 文 ELSE 文 END</li></ul></li></ul> <h3 id="notes"><a href="#notes" aria-hidden="true" class="header-anchor">#</a> notes</h3> <ul><li>COUNTはstd::mapのような感じ</li> <li>NULLの時にカウントされない</li> <li>SQLは3値論理(True/False/Unknown(不定))</li></ul> <h2 id="where"><a href="#where" aria-hidden="true" class="header-anchor">#</a> WHERE</h2> <ul><li>条件指定する句</li></ul> <h3 id="between"><a href="#between" aria-hidden="true" class="header-anchor">#</a> BETWEEN</h3> <ul><li>閉区間の範囲指定</li> <li>BETWEEN A AND Bで[A,B]の閉区間となる</li></ul> <h3 id="in"><a href="#in" aria-hidden="true" class="header-anchor">#</a> IN</h3> <ul><li>値の完全一致</li> <li>IN (A, B)で==A || ==Bと同義</li></ul> <h3 id="like"><a href="#like" aria-hidden="true" class="header-anchor">#</a> LIKE</h3> <ul><li>文字列の部分一致</li> <li>%は*と同義(ワイルドカード)</li> <li>_は任意の1文字</li></ul> <table><thead><tr><th style="text-align:center">記法</th> <th style="text-align:center">意味</th></tr></thead> <tbody><tr><td style="text-align:center"><code>LIKE 'hoge%'</code></td> <td style="text-align:center">前方一致検索</td></tr> <tr><td style="text-align:center"><code>LIKE '%hoge'</code></td> <td style="text-align:center">後方一致検索</td></tr> <tr><td style="text-align:center"><code>LIKE '%hoge%'</code></td> <td style="text-align:center">中間一致検索</td></tr></tbody></table> <h3 id="null"><a href="#null" aria-hidden="true" class="header-anchor">#</a> NULL</h3> <ul><li>ISNULLでNULLの抜き出し</li></ul> <h3 id="not"><a href="#not" aria-hidden="true" class="header-anchor">#</a> NOT</h3> <ul><li>NOTで否定</li> <li><code>&lt;&gt;</code>はNOTと同義</li></ul> <h2 id="group-by"><a href="#group-by" aria-hidden="true" class="header-anchor">#</a> GROUP BY</h2> <ul><li>結果を集約する句</li></ul> <h3 id="集約関数"><a href="#集約関数" aria-hidden="true" class="header-anchor">#</a> 集約関数</h3> <table><thead><tr><th style="text-align:center">関数</th> <th style="text-align:center">補足</th></tr></thead> <tbody><tr><td style="text-align:center">AVG(列名)</td> <td style="text-align:center">平均</td></tr> <tr><td style="text-align:center">MAX(列名)</td> <td style="text-align:center">最大値</td></tr> <tr><td style="text-align:center">MIN(列名)</td> <td style="text-align:center">最小値</td></tr> <tr><td style="text-align:center">SUM(列名)</td> <td style="text-align:center">総和</td></tr> <tr><td style="text-align:center">COUNT(*)</td> <td style="text-align:center">行数を数える(std::map)</td></tr> <tr><td style="text-align:center">COUNT(DISTINCT 列名)</td> <td style="text-align:center">列名を指定して, その列の重複値を除く行数を求める</td></tr></tbody></table> <h3 id="使用例"><a href="#使用例" aria-hidden="true" class="header-anchor">#</a> 使用例</h3> <h4 id="通常時"><a href="#通常時" aria-hidden="true" class="header-anchor">#</a> 通常時</h4> <ul><li>年齢をグループ化して各年齢の人数合計を求める時は, 次のように書く</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> age<span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span> <span class="token keyword">AS</span> age_cnt
    <span class="token keyword">FROM</span> measured_data
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> age
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>GROUP BYを使用する時, 次の値のみしかSELECTできない
<ul><li>GROUP BYの後に指定した列</li> <li>集約関数</li> <li>定数</li></ul></li></ul> <h4 id="having句を使用する時"><a href="#having句を使用する時" aria-hidden="true" class="header-anchor">#</a> HAVING句を使用する時</h4> <ul><li>GROUP BYの結果に対してvalidationを指定したい場合は, HAVING句の後に条件式を指定する</li> <li>同じ年齢の人間が5人以上いる時のみ表示する時は, 次のように書く</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> age<span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span> <span class="token keyword">AS</span> age_cnt
    <span class="token keyword">FROM</span> measured_data
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> age
    <span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="order-by"><a href="#order-by" aria-hidden="true" class="header-anchor">#</a> ORDER BY</h3> <ul><li>整列する句</li></ul> <h4 id="使用例-2"><a href="#使用例-2" aria-hidden="true" class="header-anchor">#</a> 使用例</h4> <ul><li>年齢をグループ化して各年齢の人数合計を求め, 年齢について降順で表示する時は, 次のように書く</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> age<span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span> <span class="token keyword">AS</span> age_cnt
    <span class="token keyword">FROM</span> measured_data
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> age
    <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> age <span class="token keyword">DESC</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>年齢をグループ化して各年齢の人数合計を求め, 年齢について昇順で表示する時は, 次のように書く</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> age<span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span> <span class="token keyword">AS</span> age_cnt
    <span class="token keyword">FROM</span> measured_data
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> age
    <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> age <span class="token punctuation">(</span><span class="token keyword">ASC</span><span class="token punctuation">)</span> <span class="token comment">-- ASCは省略可能</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>年齢をグループ化して各年齢の人数合計を求め, 合計人数について昇順で表示する時は, 次のように書く</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> age<span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span> <span class="token keyword">AS</span> age_cnt
    <span class="token keyword">FROM</span> measured_data
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> age
    <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token number">2</span> <span class="token keyword">DESC</span> <span class="token comment">-- SELECTで設定したもの内2番目(SUM(age))のこと</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="結合"><a href="#結合" aria-hidden="true" class="header-anchor">#</a> 結合</h3> <h4 id="内部結合と外部結合"><a href="#内部結合と外部結合" aria-hidden="true" class="header-anchor">#</a> 内部結合と外部結合</h4> <table><thead><tr><th style="text-align:center">名称</th> <th style="text-align:center">補足</th></tr></thead> <tbody><tr><td style="text-align:center">内部結合</td> <td style="text-align:center">A AND B</td></tr> <tr><td style="text-align:center">左外部結合</td> <td style="text-align:center">A</td></tr> <tr><td style="text-align:center">右外部結合</td> <td style="text-align:center">B</td></tr> <tr><td style="text-align:center">全外部結合</td> <td style="text-align:center">A OR B</td></tr></tbody></table> <h4 id="等結合と自然結合"><a href="#等結合と自然結合" aria-hidden="true" class="header-anchor">#</a> 等結合と自然結合</h4> <ul><li>いずれも, rowが同じ要素を結合する</li> <li>等結合は, そのままくっつける</li> <li>自然結合は, 同じ列を重複して表示しない</li> <li>e.g.)</li> <li>以下の表を年齢で結合する時</li></ul> <table><thead><tr><th style="text-align:center">年齢</th> <th style="text-align:center">体重</th></tr></thead> <tbody><tr><td style="text-align:center">10</td> <td style="text-align:center">40</td></tr> <tr><td style="text-align:center">11</td> <td style="text-align:center">50</td></tr> <tr><td style="text-align:center">12</td> <td style="text-align:center">55</td></tr></tbody></table> <table><thead><tr><th style="text-align:center">年齢</th> <th style="text-align:center">足のサイズ</th></tr></thead> <tbody><tr><td style="text-align:center">10</td> <td style="text-align:center">18</td></tr> <tr><td style="text-align:center">11</td> <td style="text-align:center">20</td></tr> <tr><td style="text-align:center">12</td> <td style="text-align:center">22</td></tr></tbody></table> <ul><li>等結合の場合</li></ul> <table><thead><tr><th style="text-align:center">年齢</th> <th style="text-align:center">体重</th> <th style="text-align:center">年齢</th> <th style="text-align:center">足のサイズ</th></tr></thead> <tbody><tr><td style="text-align:center">10</td> <td style="text-align:center">40</td> <td style="text-align:center">10</td> <td style="text-align:center">18</td></tr> <tr><td style="text-align:center">11</td> <td style="text-align:center">50</td> <td style="text-align:center">11</td> <td style="text-align:center">20</td></tr> <tr><td style="text-align:center">12</td> <td style="text-align:center">55</td> <td style="text-align:center">12</td> <td style="text-align:center">22</td></tr></tbody></table> <ul><li>自然結合の場合</li></ul> <table><thead><tr><th style="text-align:center">年齢</th> <th style="text-align:center">体重</th> <th style="text-align:center">足のサイズ</th></tr></thead> <tbody><tr><td style="text-align:center">10</td> <td style="text-align:center">40</td> <td style="text-align:center">18</td></tr> <tr><td style="text-align:center">11</td> <td style="text-align:center">50</td> <td style="text-align:center">20</td></tr> <tr><td style="text-align:center">12</td> <td style="text-align:center">55</td> <td style="text-align:center">22</td></tr></tbody></table> <h3 id="和・差・直積・積・商"><a href="#和・差・直積・積・商" aria-hidden="true" class="header-anchor">#</a> 和・差・直積・積・商</h3> <ul><li>集合RとSについて考える</li></ul> <h4 id="和"><a href="#和" aria-hidden="true" class="header-anchor">#</a> 和</h4> <ul><li>R <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>∪</mo></mrow><annotation encoding="application/x-tex">\cup</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.55556em;"></span><span class="strut bottom" style="height:0.55556em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord">∪</span></span></span></span> S</li> <li>UNIONで和を表す</li> <li>UNION ALLと書くと重複を許す</li></ul> <h4 id="差"><a href="#差" aria-hidden="true" class="header-anchor">#</a> 差</h4> <ul><li>R-S</li> <li>EXCEPTで差を表す</li></ul> <h4 id="直積"><a href="#直積" aria-hidden="true" class="header-anchor">#</a> 直積</h4> <ul><li>R <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>×</mo></mrow><annotation encoding="application/x-tex">\times</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord">×</span></span></span></span> S</li></ul> <h4 id="積"><a href="#積" aria-hidden="true" class="header-anchor">#</a> 積</h4> <ul><li>R <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>∩</mo></mrow><annotation encoding="application/x-tex">\cap</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.55556em;"></span><span class="strut bottom" style="height:0.55556em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord">∩</span></span></span></span> S</li> <li>INTERSECTで積を表す</li></ul> <h4 id="商"><a href="#商" aria-hidden="true" class="header-anchor">#</a> 商</h4> <ul><li>R <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>÷</mo></mrow><annotation encoding="application/x-tex">\div</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord">÷</span></span></span></span> S
<ul><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∃</mi></mrow><annotation encoding="application/x-tex">\exists</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">∃</span></span></span></span> T, S <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>×</mo></mrow><annotation encoding="application/x-tex">\times</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord">×</span></span></span></span> T = R <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>⇒</mo></mrow><annotation encoding="application/x-tex">\Rightarrow</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.36687em;"></span><span class="strut bottom" style="height:0.36687em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mrel">⇒</span></span></span></span> R <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>÷</mo></mrow><annotation encoding="application/x-tex">\div</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord">÷</span></span></span></span> S = Tと定義する</li></ul></li></ul> <h1 id="_03-18"><a href="#_03-18" aria-hidden="true" class="header-anchor">#</a> 03/18</h1> <h2 id="h30-午後1-1"><a href="#h30-午後1-1" aria-hidden="true" class="header-anchor">#</a> H30 午後1-1</h2> <h2 id="概念データモデルと関係スキーマの分類について"><a href="#概念データモデルと関係スキーマの分類について" aria-hidden="true" class="header-anchor">#</a> 概念データモデルと関係スキーマの分類について</h2> <ul><li>トランザクションとマスタで分類できる</li> <li>さらにマスタにおいて,「人・組織系」や「商品系」といった分類もできる</li> <li>大きいデータモデルは, 線で区切ってナンバリングしてから考えると楽</li></ul> <h2 id="リレーションの矢印について"><a href="#リレーションの矢印について" aria-hidden="true" class="header-anchor">#</a> リレーションの矢印について</h2> <ul><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>→</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A \rightarrow B</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">A</span><span class="mrel">→</span><span class="mord mathit" style="margin-right:0.05017em;">B</span></span></span></span>のとき, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>:</mo><mi>B</mi><mo>=</mo><mn>1</mn><mo>:</mo></mrow><annotation encoding="application/x-tex">A:B = 1:</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">A</span><span class="mrel">:</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mrel">:</span></span></span></span>多</li> <li>矢印の先が多</li> <li>記載がない場合は1:多</li></ul> <h2 id="サブタイプとスーパータイプ"><a href="#サブタイプとスーパータイプ" aria-hidden="true" class="header-anchor">#</a> サブタイプとスーパータイプ</h2> <ul><li>汎化した側のエンティティをスーパータイプという</li> <li>特化した側のエンティティをサブタイプという</li> <li>例えば, 料理というスーパータイプに対して, 和食セットや洋食セット, デザートコースといったサブタイプが存在する</li></ul> <h2 id="排他的サブタイプと共存的サブタイプ"><a href="#排他的サブタイプと共存的サブタイプ" aria-hidden="true" class="header-anchor">#</a> 排他的サブタイプと共存的サブタイプ</h2> <ul><li><p>サブタイプが共通部分を持つときには共存的サブタイプに分類され, 共通部分を持たないとき排他的サブタイプに分類される</p></li> <li><p>例えば, セット類とサービス対象類というスーパータイプが存在したとき, 和食セットがサービス対象ならばこれはキュゾン的サブタイプに分類される</p></li> <li><p>要するに, 複数のスーパータイプに属することができる場合, 共存的サブタイプに分類されるわけだ</p></li> <li><p>「〜で分類」や「どちらか一方にしか存在できない」, 「両方に属するものは損じ足ない」という文言がある場合は, 排他的サブタイプに分類される</p></li></ul> <h1 id="記述から読み取れるエンティティと属性"><a href="#記述から読み取れるエンティティと属性" aria-hidden="true" class="header-anchor">#</a> 記述から読み取れるエンティティと属性</h1> <ul><li>「〜で分類」<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.36687em;"></span><span class="strut bottom" style="height:0.36687em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mrel">→</span></span></span></span> サブタイプの切り口
<ul><li>AをBで分類
<ul><li>AにはBが必要</li> <li>エンティティAの属性としてBが挙げられる</li></ul></li></ul></li> <li>「〜で分類」(サブタイプ無しver.) <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.36687em;"></span><span class="strut bottom" style="height:0.36687em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mrel">→</span></span></span></span> ただの属性として持たせる
<ul><li>AをBで分類
<ul><li>エンティティAの属性としてBを持たせる</li></ul></li></ul></li> <li>「〜で登録する」<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.36687em;"></span><span class="strut bottom" style="height:0.36687em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mrel">→</span></span></span></span> 属性として持たせる
<ul><li>AにはBを登録する
<ul><li>エンティティAの属性としてBを持たせる</li></ul></li></ul></li></ul> <h1 id="キー"><a href="#キー" aria-hidden="true" class="header-anchor">#</a> キー</h1> <h2 id="スーパーキー-super-key"><a href="#スーパーキー-super-key" aria-hidden="true" class="header-anchor">#</a> スーパーキー(Super Key)</h2> <ul><li>タプルを一意に識別できるキーのこと</li> <li>候補キーに, 様々な組み合わせで他の属性を付け足したもの
<ul><li>冪集合のようなもの</li></ul></li></ul> <h2 id="候補キー-candidate-key"><a href="#候補キー-candidate-key" aria-hidden="true" class="header-anchor">#</a> 候補キー(Candidate Key)</h2> <ul><li>次の2つの制約を持つ
<ul><li>タプルを一意に識別できること</li> <li>スーパーキーの中で極小(それ以上分解できないもの)
<ul><li>極小とは, 余計な属性を含まないもの</li> <li>それ以上属性を減らすとタプルの識別ができなくなってしまうもの</li></ul></li></ul></li></ul> <h2 id="主キー-primary-key"><a href="#主キー-primary-key" aria-hidden="true" class="header-anchor">#</a> 主キー(Primary Key)</h2> <ul><li>次の2つの制約をもつ
<ul><li>一意性制約</li> <li>非ナル(NULLが認められない)</li></ul></li> <li>候補キーの中から元もふさわしいものが選ばれる</li></ul> <h2 id="代理キー-alternate-key"><a href="#代理キー-alternate-key" aria-hidden="true" class="header-anchor">#</a> 代理キー(Alternate Key)</h2> <ul><li>候補キーの中で主キーに選ばれなかったキー</li></ul> <h2 id="小まとめ"><a href="#小まとめ" aria-hidden="true" class="header-anchor">#</a> 小まとめ</h2> <ul><li>主キー <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>∈</mo></mrow><annotation encoding="application/x-tex">\in</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.5391em;"></span><span class="strut bottom" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="base textstyle uncramped"><span class="mrel">∈</span></span></span></span> 候補キー <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>⊂</mo></mrow><annotation encoding="application/x-tex">\subset</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.5391em;"></span><span class="strut bottom" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="base textstyle uncramped"><span class="mrel">⊂</span></span></span></span> スーパーキー</li></ul> <h2 id="サロゲートキー-surrogate-key"><a href="#サロゲートキー-surrogate-key" aria-hidden="true" class="header-anchor">#</a> サロゲートキー(Surrogate Key)</h2> <ul><li>連番がよく使用される</li> <li>一意性を確保して主キーとして使用されるためだけに使用される</li> <li>次のような場合に使用される
<ul><li>主キーが複合キーの場合
<ul><li>主キーが複数の属性で構成されていると扱いづらい</li> <li>そのため, 主キーの代わりにサロゲートキーが用いられることがある</li></ul></li> <li>データウェアハウスで, 長期間の履歴を管理したい場合
<ul><li>主キーはstringになることがあるが, integerで管理した方が楽</li> <li>数字列なので一意性が損なわれづらい</li></ul></li></ul></li></ul> <h2 id="外部キー"><a href="#外部キー" aria-hidden="true" class="header-anchor">#</a> 外部キー</h2> <ul><li>他のリレーションの主キー(または候補キーでも良い)を参照する項目のこと</li> <li>エンティティA,Bについて, A-Bという1:1のリレーションがあるとする</li> <li>このとき, Aの主キーpを参照するBの外部キーqが存在するとする</li> <li>Aの主キーpには実線で下線が引かれる</li> <li>Bの外部キーqには破線で下線が引かれる</li></ul> <h1 id="_03-19"><a href="#_03-19" aria-hidden="true" class="header-anchor">#</a> 03/19</h1> <h2 id="h30-午後1-2"><a href="#h30-午後1-2" aria-hidden="true" class="header-anchor">#</a> H30 午後1-2</h2> <h2 id="sql"><a href="#sql" aria-hidden="true" class="header-anchor">#</a> SQL</h2> <ul><li>CURRENT_DATE値関数によって現在日時を示すDATE型の値が取得できる</li> <li>DISTINCT句で重複を解消できる</li> <li>GROUP BY句の後に来れるのはHAVING句かORDER BY句
<ul><li>グループ化した後に条件があればHAVING句</li> <li>グループ化した後にソートされていればORDER BY句
<ul><li>ASCは昇順, DESCは降順</li> <li>ASCは省略可能</li></ul></li></ul></li></ul> <h2 id="参照制約"><a href="#参照制約" aria-hidden="true" class="header-anchor">#</a> 参照制約</h2> <ul><li>テーブルとテーブルが参照関係にある場合の整合性制約</li> <li>参照元テーブルに外部キーを指定することで, テーブル間の整合性を保つ</li></ul> <table><thead><tr><th style="text-align:center">OPTION</th> <th style="text-align:center">詳細</th></tr></thead> <tbody><tr><td style="text-align:center">NO ACTION</td> <td style="text-align:center">参照元テーブルにデータが存在している場合, 参照先テーブルでは削除と更新ができない</td></tr> <tr><td style="text-align:center">''</td> <td style="text-align:center">オプションを設定しない場合, NO ACTIONに設定される</td></tr> <tr><td style="text-align:center">CASCADE</td> <td style="text-align:center">参照元テーブルにデータが存在している場合でも, 参照先テーブルで削除と更新ができる</td></tr> <tr><td style="text-align:center">''</td> <td style="text-align:center">データは連携して削除される</td></tr> <tr><td style="text-align:center">SET NULL</td> <td style="text-align:center">参照元テーブルにデータが存在している場合でも, 参照先テーブルで削除と更新ができる</td></tr> <tr><td style="text-align:center">''</td> <td style="text-align:center">参照元テーブルのデータはNULLに設定される</td></tr></tbody></table> <ul><li>参照先テーブルに関して(raw data)
<ul><li>行を追加することは問題ない</li> <li>行を削除する場合に, 参照元テーブルの外部キーに同じ値が存在している場合, 削除はできない
<ul><li>参照関係が存在している場合に削除はできない</li></ul></li> <li>ある行を更新する場合, 参照先テーブルの外部キーに存在する値への更新なら可能になる</li></ul></li> <li>参照元テーブルに関して(instance data)
<ul><li>行を削除することは問題ない</li> <li>行を追加する場合に, 参照先テーブルに存在するものかNULLしか追加できない</li> <li>行を更新する場合に, 更新後の値が参照先テーブルに存在する値にしか更新できない</li></ul></li></ul> <h1 id="h30-午後1-3"><a href="#h30-午後1-3" aria-hidden="true" class="header-anchor">#</a> H30 午後1-3</h1> <h2 id="notes-2"><a href="#notes-2" aria-hidden="true" class="header-anchor">#</a> Notes</h2> <ul><li>「〜で識別する」や「〜で分類する」といった記述がある場合, 一意性を持つことが多い</li> <li>ただし, 「1つ以上の〜」という記述がある場合, 一意性が失われることもあるため注意する</li> <li>SQLのBETWEEN句は閉区間である
<ul><li>BETWEEN A AND B</li> <li>[A, B]</li></ul></li> <li>大規模な処理は細分化するとよい
<ul><li>先行/並列/後続処理の3ステップに分けて考えると分類が楽</li></ul></li></ul> <h2 id="ユニーク索引と非ユニーク索引"><a href="#ユニーク索引と非ユニーク索引" aria-hidden="true" class="header-anchor">#</a> ユニーク索引と非ユニーク索引</h2> <ul><li>ユニーク索引は, 表内のデータの2つの行が同じキー値を持たないようにすることにより, データ整合性の維持に貢献する索引のこと(By IBM)</li> <li>ユニークサック員は, 値の重複を許可しない索引</li> <li>非ユニーク索引は, 値の重複を許可する索引</li></ul> <h2 id="表探索と索引探索"><a href="#表探索と索引探索" aria-hidden="true" class="header-anchor">#</a> 表探索と索引探索</h2> <h3 id="表探索"><a href="#表探索" aria-hidden="true" class="header-anchor">#</a> 表探索</h3> <ul><li>索引を使用せずに全データページを探索する</li> <li>逐次探索</li> <li>O(N)</li></ul> <h4 id="索引探索"><a href="#索引探索" aria-hidden="true" class="header-anchor">#</a> 索引探索</h4> <ul><li>検索条件に適した索引によって対象行を絞り込んだうえで, データページを探索する</li> <li>O(1)くらいか?</li></ul> <h2 id="正規化"><a href="#正規化" aria-hidden="true" class="header-anchor">#</a> 正規化</h2> <h3 id="非正規系"><a href="#非正規系" aria-hidden="true" class="header-anchor">#</a> 非正規系</h3> <div class="tip custom-block"><p class="custom-block-title">定義</p> <ul><li>リレーションRの属性の中に, 単一でない値が含まれている</li></ul></div> <ul><li>同じ要素が繰り返しあらわれているとき, 非正規系にあたる</li> <li>e.g.) 伝票</li></ul> <h3 id="第1正規系"><a href="#第1正規系" aria-hidden="true" class="header-anchor">#</a> 第1正規系</h3> <div class="tip custom-block"><p class="custom-block-title">定義</p> <ul><li>リレーションRの全ての属性が単一値である</li></ul></div> <ul><li>非正規系の繰り返し項目を無くした形がこれ</li> <li>部分関数従属性があると, 第2正規系になれないやつ</li></ul> <h3 id="第2正規系"><a href="#第2正規系" aria-hidden="true" class="header-anchor">#</a> 第2正規系</h3> <div class="tip custom-block"><p class="custom-block-title">定義</p> <ul><li>リレーションRが次の2つの条件を満たす
<ul><li>第1正規系であること(全ての値が単一値である)</li> <li>全ての非キー属性は, いかなる候補キーにも部分関数従属していない(完全関数従属である)こと
<ul><li>部分関数従属とは, 候補キーの一部が非キー属性を決定している状態</li></ul></li></ul></li></ul></div> <ul><li>第1正規系よりも強いが, 第3正規系よりは弱い</li> <li>候補キーの全てが, 非キー属性に対して完全に関数従属している</li></ul> <h3 id="第3正規系"><a href="#第3正規系" aria-hidden="true" class="header-anchor">#</a> 第3正規系</h3> <div class="tip custom-block"><p class="custom-block-title">定義</p> <ul><li>リレーションRが次の2つの条件を満たす
<ul><li>第2正規系であること(全ての値が単一値であり, かつ全ての非キー属性が完全関数従属であること)</li> <li>全ての非キー属性は, いかなる候補キーにも推移的関数従属していない</li></ul></li></ul></div> <ul><li>候補キー(A) <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.36687em;"></span><span class="strut bottom" style="height:0.36687em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mrel">→</span></span></span></span> 非キー属性(B) <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.36687em;"></span><span class="strut bottom" style="height:0.36687em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mrel">→</span></span></span></span> 非キー属性(C)のような推移が存在する時</li> <li>真ん中の非キー属性を候補キーとして,</li> <li>(A) <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.36687em;"></span><span class="strut bottom" style="height:0.36687em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mrel">→</span></span></span></span> (B), (B) <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.36687em;"></span><span class="strut bottom" style="height:0.36687em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mrel">→</span></span></span></span> (C)</li> <li>のようなリレーションに変わった時に第3正規系になる</li></ul> <div class="danger custom-block"><p class="custom-block-title">推移的関数従属について</p> <p>再帰的に非キーから候補キーにリレーションが存在する時, これは推移的関数従属ではない</p></div> <h3 id="ボイス・コッド正規系"><a href="#ボイス・コッド正規系" aria-hidden="true" class="header-anchor">#</a> ボイス・コッド正規系</h3> <div class="tip custom-block"><p class="custom-block-title">定義</p> <ul><li>リレーションRに存在するあらゆる関数従属性に関して, 次のいずれかが成立する
<ul><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X \rightarrow Y</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mrel">→</span><span class="mord mathit" style="margin-right:0.22222em;">Y</span></span></span></span>は自明な関数従属性である
<ul><li>自明な関数従属とは, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>⊂</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A \subset B</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="base textstyle uncramped"><span class="mord mathit">A</span><span class="mrel">⊂</span><span class="mord mathit" style="margin-right:0.05017em;">B</span></span></span></span>のようなときの <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>→</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A \rightarrow B</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">A</span><span class="mrel">→</span><span class="mord mathit" style="margin-right:0.05017em;">B</span></span></span></span>のリレーションのこと</li></ul></li> <li>XはRのスーパーキーである</li></ul></li></ul></div> <h4 id="ボイス・コッド正規系のデメリット"><a href="#ボイス・コッド正規系のデメリット" aria-hidden="true" class="header-anchor">#</a> ボイス・コッド正規系のデメリット</h4> <ul><li>全ての関数従属性が保存されるわけではない
<ul><li>情報無損失分解ではないということ(第1-3正規系は情報無損失分解)</li></ul></li></ul> <h3 id="第4正規系"><a href="#第4正規系" aria-hidden="true" class="header-anchor">#</a> 第4正規系</h3> <div class="tip custom-block"><p class="custom-block-title">定義</p> <ul><li>リレーションRに存在するあらゆる多値従属性について, 次のいずれかが成立する
<ul><li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X \rightarrow \rightarrow Y</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mrel">→</span><span class="mrel">→</span><span class="mord mathit" style="margin-right:0.22222em;">Y</span></span></span></span>は自明な多値関数従属である
<ul><li>多値従属性とは, 項目Xの値が1つ決まれば, 項目Yの値が1つ以上決まる性質のこと</li></ul></li> <li>XはRのスーパーキーである</li></ul></li></ul></div> <h3 id="第5正規系"><a href="#第5正規系" aria-hidden="true" class="header-anchor">#</a> 第5正規系</h3> <div class="tip custom-block"><p class="custom-block-title">定義</p> <ul><li>リレーションRに存在するあらゆる結合従属性について, つぎのいずれかが成立する。
<ul><li>*(A1, A2, ..., An)は自明な結合従属性である</li> <li>AiはRのスーパーキーである</li></ul></li></ul></div> <h2 id="ビジネスモデル"><a href="#ビジネスモデル" aria-hidden="true" class="header-anchor">#</a> ビジネスモデル</h2></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">2019-3-19 10:57:29</span></div></div> <!----> </div> <!----></div></div>
    <script src="/note/assets/js/app.7aa1caf6.js" defer></script><script src="/note/assets/js/15.54ea7ecb.js" defer></script>
  </body>
</html>
