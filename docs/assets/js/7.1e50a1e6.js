(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{173:function(t,e,a){"use strict";a.r(e);var s=a(0),n=Object(s.a)({},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[t._m(0),t._v(" "),a("p",[a("a",{attrs:{href:"https://re-engines.com/2018/04/09/vue-js%E3%81%A8rails%E3%81%A7todo%E3%82%A2%E3%83%97%E3%83%AA%E3%81%AE%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB%E3%81%BF%E3%81%9F%E3%81%84%E3%81%AA%E3%82%82%E3%81%AE%E3%82%92/",target:"_blank",rel:"noopener noreferrer"}},[t._v("こちら"),a("OutboundLink")],1),t._v("のサイトを参考にチュートリアルを進めています.")]),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._m(4),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),t._m(8),t._v(" "),a("p",[t._v("毎回のコンパイルが面倒なので, 変更を検出して自動コンパイルする."),a("br"),t._v(" "),a("a",{attrs:{href:"https://medium.com/statuscode/introducing-webpacker-7136d66cddfb",target:"_blank",rel:"noopener noreferrer"}},[t._v("Introducing Webpacker"),a("OutboundLink")],1)]),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),a("p",[t._v("以下で示すProcfile.devの内容を実行する.")]),t._v(" "),t._m(12),t._m(13),t._v(" "),a("p",[a("code",[t._v("rails s")]),t._v("と"),a("code",[t._v("bin/webpack-dev-server")]),t._v("を実行する."),a("br"),t._v("\nポート指定のために, "),a("code",[t._v("-b 0.0.0.0")]),t._v("オプションをつける."),a("br"),t._v(" "),a("a",{attrs:{href:"https://qiita.com/Tocyuki/items/de66987ead2183e4fcae",target:"_blank",rel:"noopener noreferrer"}},[t._v("RailsでポートとIPアドレスを指定する方法"),a("OutboundLink")],1),t._v(".")]),t._v(" "),t._m(14),t._m(15),t._v(" "),t._m(16),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._v(" "),t._m(20),t._v(" "),t._m(21),t._v(" "),t._m(22),t._v(" "),t._m(23),t._m(24),t._v(" "),t._m(25),t._m(26),t._v(" "),t._m(27),t._v(" "),t._m(28),t._m(29),t._v(" "),t._m(30),t._v(" "),a("p",[t._v("追加するアクションは3つで, 以下の通り.")]),t._v(" "),t._m(31),t._v(" "),t._m(32),t._v(" "),t._m(33),t._m(34),t._v(" "),a("p",[a("code",[t._v("app/views/api/tasks/")]),t._v("下に, "),a("code",[t._v("index")]),t._v("と"),a("code",[t._v("show")]),t._v("のための2つのjbuilderファイル(json)を配置."),a("br"),t._v("\njbuilderについては, 以下を参照."),a("br"),t._v(" "),a("a",{attrs:{href:"https://qiita.com/ryouzi/items/06cb0d4aa7b6527b3645",target:"_blank",rel:"noopener noreferrer"}},[t._v("Railsのjbuilderの書き方と便利なイディオムやメソッド"),a("OutboundLink")],1)]),t._v(" "),t._m(35),t._m(36),t._m(37),t._v(" "),t._m(38),t._v(" "),t._m(39),t._m(40),t._v(" "),t._m(41),t._v(" "),t._m(42),t._v(" "),t._m(43),t._m(44),t._v(" "),a("p",[t._v("あとで検証する. 今は眠いのだ.")]),t._v(" "),t._m(45),t._v(" "),t._m(46),t._v(" "),t._m(47),t._v(" "),t._m(48),t._v(" "),a("p",[a("a",{attrs:{href:"https://qiita.com/Yarimizu14/items/c81a8cf1859f954b953e",target:"_blank",rel:"noopener noreferrer"}},[t._v("【Rails】RailsでAPIの簡単なトークン認証を実装する"),a("OutboundLink")],1),a("br"),t._v("\nこちらの記事を参考にした.")]),t._v(" "),t._m(49),t._v(" "),t._m(50),t._v(" "),t._m(51),t._v(" "),t._m(52),t._m(53),t._v(" "),t._m(54),t._v(" "),a("p",[a("a",{attrs:{href:"https://qiita.com/ochiochi/items/966b884eb17045dfb929",target:"_blank",rel:"noopener noreferrer"}},[t._v("Rails5 APIで認証付きのWebAPIを作ってみる"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("こちらの記事を参考にしてみる.")]),t._v(" "),a("p",[t._v("これユーザ認証だ.")]),t._v(" "),a("p",[t._v("uhmmmmmmmmmm....")]),t._v(" "),t._m(55),t._v(" "),t._m(56),t._v(" "),t._m(57),t._v(" "),t._m(58),t._v(" "),t._m(59),t._m(60),t._v(" "),t._m(61),t._v(" "),t._m(62),t._v(" "),a("p",[t._v("その後, Materializeを適応するために以下の2ファイルを変更.")]),t._v(" "),a("ul",[a("li",[t._v("Stylesheetsはセミコロン抜け注意.")]),t._v(" "),t._m(63),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/mkhairi/materialize-sass/tree/v0.100",target:"_blank",rel:"noopener noreferrer"}},[t._v("materialize-sassの公式"),a("OutboundLink")],1)])]),t._v(" "),t._m(64),t._m(65),t._m(66)])},[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"vue-x-rails"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vue-x-rails","aria-hidden":"true"}},[this._v("#")]),this._v(" Vue x Rails")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"_2019-1-26"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2019-1-26","aria-hidden":"true"}},[this._v("#")]),this._v(" 2019/1/26")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"プロジェクトの生成"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#プロジェクトの生成","aria-hidden":"true"}},[this._v("#")]),this._v(" プロジェクトの生成")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("$ rails new {project_name} --webpack=vue\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"vue-jsの参照"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vue-jsの参照","aria-hidden":"true"}},[this._v("#")]),this._v(" Vue.jsの参照")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",[t._v("Viewのページで, "),a("code",[t._v("javascript_pack_tag")]),t._v("を使用することで,"),a("code",[t._v("app/javascript/packs")]),t._v("以下にあるJSファイルを探す."),a("br"),t._v("\nインストール時に"),a("code",[t._v("app/javascript/packs/hello_vue.js")]),t._v("というファイルが生成されているので, これを"),a("code",[t._v("index")]),t._v("アクションにて読み込ませる.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"devサーバの自動コンパイル"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#devサーバの自動コンパイル","aria-hidden":"true"}},[this._v("#")]),this._v(" devサーバの自動コンパイル")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"foreman-gemのインストール"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#foreman-gemのインストール","aria-hidden":"true"}},[this._v("#")]),this._v(" foreman gemのインストール")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("bin/webpack")]),this._v("というコマンドでコンパイルされる.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("foreman")]),this._v("のGemをインストールする."),e("br"),this._v("\nGemfileファイルに"),e("code",[this._v("gem 'foreman'")]),this._v("を追加して"),e("code",[this._v("bundle install")]),this._v("する.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"bin-serverとprocfileの追記"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#bin-serverとprocfileの追記","aria-hidden":"true"}},[this._v("#")]),this._v(" bin/serverとProcfileの追記")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"bin-server"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#bin-server","aria-hidden":"true"}},[this._v("#")]),this._v(" bin/server")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("// bin/server\n#! /bin/bash -i\nbundle install\nbundle exec foreman start -f Procfile.dev\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"packfile-dev"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#packfile-dev","aria-hidden":"true"}},[this._v("#")]),this._v(" Packfile.dev")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("// Procfile.dev\nweb: bundle exec rails s -b 0.0.0.0\nwebpacker: ./bin/webpack-dev-server\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"実践"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#実践","aria-hidden":"true"}},[this._v("#")]),this._v(" 実践")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("app/javascript/app.vue")]),this._v("のmessageを編集するとすぐにコンパイルされる.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"apiの準備"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#apiの準備","aria-hidden":"true"}},[this._v("#")]),this._v(" APIの準備")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"テーブルとモデルの作成"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#テーブルとモデルの作成","aria-hidden":"true"}},[this._v("#")]),this._v(" テーブルとモデルの作成")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("テーブル名は"),e("code",[this._v("tasks")]),this._v(", モデル名は"),e("code",[this._v("Task")]),this._v("とする.")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[t._v("Column Name")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("Type")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("Options")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("name")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("string")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("presence: true")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("is_done")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("boolean")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("presence: true, default: false")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("created_at")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("datetime")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("null: false")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("updated_at")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("datetime")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("null: false")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("とりあえず,"),e("br"),this._v(" "),e("code",[this._v("$ rails g model Task name:string is_done:boolean")]),this._v(".")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("その後, "),e("code",[this._v("options")]),this._v("の内容を以下のようにして"),e("code",[this._v("db/migrate/*.rb")]),this._v("に追記.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("// db/migrate/*.rb\nclass CreateTasks < ActiveRecord::Migration[5.1]\n  def change\n    create_table :tasks do |t|\n      t.string :name    , presence: true\n      t.boolean :is_done, default: false, presence: true\n\n      t.timestamps\n    end\n  end\nend\n\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("ついでに, "),e("code",[this._v("app/models/task.rb")]),this._v("に上で定義したvalidatesの内容を追加.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("// app/models/task.rb\nclass Task < ApplicationRecord\n  validates :name, presence: true\nend\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"apiのルーティングの設定"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#apiのルーティングの設定","aria-hidden":"true"}},[this._v("#")]),this._v(" APIのルーティングの設定")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("urlを"),e("code",[this._v("api/tasks")]),this._v("のようにnamespaceを切る."),e("br"),this._v("\nそうすることで, api用のルーティングが用意できる."),e("br"),this._v("\n(具体的には, "),e("code",[this._v("/api/*")]),this._v("のようにnamespaceが区切られる)")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("// config/routes.rb\nRails.application.routes.draw do\n  # For details on the DSL available within this file, see http://guides.rubyonrails.org/routing.html\n  root to: 'home#index'\n  \n  namespace :api, format: 'json' do\n    resources :tasks, only: [:index, :create, :update]\n  end\nend\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"コントローラを作成"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#コントローラを作成","aria-hidden":"true"}},[this._v("#")]),this._v(" コントローラを作成")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",[t._v("API用のコントローラを作成する."),a("br"),t._v("\ncontrollerの場所は, "),a("code",[t._v("app/controllers/")]),t._v("以下に新しく"),a("code",[t._v("api")]),t._v("というディレクトリを作成する."),a("br"),t._v("\n名前は慣習的に"),a("code",[t._v("tasks_controller.rb")]),t._v("とする.")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[t._v("Action Name")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("REST")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("Overview")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("index")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("GET /tasks")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("更新順の@tasksを返す")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("create")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("POST /tasks")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("新しく@taskを作ってデータベースに保存")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("''")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("''")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("保存できない場合, "),a("code",[t._v(":unprocessable_entity")]),t._v("ステータスの"),a("code",[t._v("json")]),t._v("ファイルをrenderする")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("update")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("PATCH/PUT /tasks/*")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("@taskを更新する")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("''")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("''")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("更新できなかった場合, "),a("code",[t._v(":unprocessable_entity")]),t._v("ステータスの"),a("code",[t._v("json")]),t._v("ファイルをrenderする")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("中身を勝手にいじられないように, "),e("code",[this._v("private")]),this._v("で"),e("code",[this._v("task_params")]),this._v("を定義しておく.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("# -*- coding: utf-8 -*-\nclass Api::TasksController < ApplicationController\n \n  # GET /tasks\n  def index\n    # 後々のために, 更新順で返す\n    @tasks = Task.order('updated_at DESC')\n  end\n\n  # POST /tasks\n  def create\n    @task = Task.new(task_params)\n    \n    if @task.save\n      render :show, status :created\n    else\n      render json: @task.errors, status: :unprocessable_entity\n    end\n  end\n\n  # PATCH/PUT /tasks/*\n  def update\n    @task = Task.find(params[:id])\n    \n    if @task.update(task_params)\n      render :show, status: :ok\n    else\n      render json: @task.errors, status: :unprocessable_entity\n    end\n  end\n\n  private\n  def task_params\n    params.fetch(:task, {}).permit(\n      :name, :is_done\n    )\n  end\nend\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"viewのjsonファイル"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#viewのjsonファイル","aria-hidden":"true"}},[this._v("#")]),this._v(" ViewのJSONファイル")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("// app/views/api/tasks/index.json.jbuilder\n// `set!`は, `:tasks`という属性をまとめるメソッド\njson.set! :tasks do\n  // `array!`は, `@tasks`の内容をループで回すメソッド \n  // 返り値は配列になる\n  json.array! @tasks do |task|\n    // `extract!`は, `task`の中身を指定して返せるメソッド\n    // 以下の場合は, `task`の中身を, `:id`, `:name`, ..., `:updated_at`をまとめて返すことになる\n    json.extract! task, :id, :name, :is_done, :created_at, :updated_at\n  end\nend\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("// app/views/api/tasks/show.json.jbuilder\njson.set! :task do\n  json.extract! @task, :id, :name, :is_done, :created_at, :updated_at\nend\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"seeds-rbを作成し-curlコマンドで確認"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#seeds-rbを作成し-curlコマンドで確認","aria-hidden":"true"}},[this._v("#")]),this._v(" seeds.rbを作成し, curlコマンドで確認")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("初期値データの作成."),e("br"),this._v("\n今回は未達成Taskを2つ, 達成済みTaskを1つ作る.\nおなじみの"),e("code",[this._v("seeds.rb")]),this._v("を以下のように設定.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("// db/seeds.rb\n2.times { Task.create!(name: 'Sample Task') }\n1.times { Task.create!(name: 'Done Task', is_done: true) }\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("コマンドは"),e("code",[this._v("$ rails db:seed")]),this._v("."),e("br"),this._v("\nリセットする場合は"),e("code",[this._v("$ rails db:setup")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"curlでgetしてみる"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#curlでgetしてみる","aria-hidden":"true"}},[this._v("#")]),this._v(" curlでGETしてみる")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("$ curl -X GET 0.0.0.0:5000/api/tasks | jq")]),this._v("を叩く.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v('{\n  "tasks": [\n    {\n      "id": 6,\n      "name": "Done Task",\n      "is_done": true,\n      "created_at": "2019-01-26T13:54:22.507Z",\n      "updated_at": "2019-01-26T13:54:22.507Z"\n    },\n    {\n      "id": 5,\n      "name": "Sample Task",\n      "is_done": false,\n      "created_at": "2019-01-26T13:54:22.496Z",\n      "updated_at": "2019-01-26T13:54:22.496Z"\n    },\n    {\n      "id": 4,\n      "name": "Sample Task",\n      "is_done": false,\n      "created_at": "2019-01-26T13:54:22.486Z",\n      "updated_at": "2019-01-26T13:54:22.486Z"\n    },\n    {\n      "id": 3,\n      "name": "Done Task",\n      "is_done": true,\n      "created_at": "2019-01-26T13:54:07.951Z",\n      "updated_at": "2019-01-26T13:54:07.951Z"\n    },\n    {\n      "id": 2,\n      "name": "Sample Task",\n      "is_done": false,\n      "created_at": "2019-01-26T13:54:07.939Z",\n      "updated_at": "2019-01-26T13:54:07.939Z"\n    },\n    {\n      "id": 1,\n      "name": "Sample Task",\n      "is_done": false,\n      "created_at": "2019-01-26T13:54:07.929Z",\n      "updated_at": "2019-01-26T13:54:07.929Z"\n    }\n  ]\n}\n')])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("なぜか2倍作成されている..."),e("br"),this._v("\nWhy...?")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"curlでpostしてみる"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#curlでpostしてみる","aria-hidden":"true"}},[this._v("#")]),this._v(" curlでPOSTしてみる")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("$ curl -X POST 0.0.0.0:5000/api/tasks -d 'task[hoge]=fuga'")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("ActionController::InvalidAuthenticityToken")]),this._v("が返ってくる."),e("br"),this._v("\n認証していないのが問題らしい.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"認証機能の追加"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#認証機能の追加","aria-hidden":"true"}},[this._v("#")]),this._v(" 認証機能の追加")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"_2019-1-27"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2019-1-27","aria-hidden":"true"}},[this._v("#")]),this._v(" 2019/1/27")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"認証機能の追加-つづき"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#認証機能の追加-つづき","aria-hidden":"true"}},[this._v("#")]),this._v(" 認証機能の追加(つづき)")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("追加するのは, "),e("code",[this._v("app/controllers/application_controller.rb")]),this._v("."),e("br"),this._v("\n以下のように追加.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("class ApplicationController < ActionController::Base\n\n  include ActionController::HttpAuthentication::Token::ControllerMethods\n\n  before_action :authenticate\n  protect_from_forgery with: :exception\n  \n  protected\n  def authenticate\n    authenticate_token || render_unauthenticated\n  end\n\n  def authenticate_token\n    authenticate_with_http_token do |token, options|\n      token == 'hoge'\n    end\n  end\n  \n  def render_unauthenticated\n    # render_errors(:unauthorized, ['invalid token'])\n    obj = { message: 'token invalid' }\n    render json: obj, status: :unauthorized\n  end\n  \nend\n\n")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",[t._v("この後,"),a("br"),t._v(" "),a("code",[t._v("$ curl -X POST -H 'Content-Type:application/json' -H 'Authorization: Token hoge' 0.0.0.0:5000/api/tasks -d '{ \"task\"=>{\"name\":\"fuga\"} }'")]),a("br"),t._v("\nを叩くと,"),a("br"),t._v(" "),a("code",[t._v("Can't verify CSRF token authenticity")]),t._v("と怒られる."),a("br"),t._v("\nこのtokenだとダメなのか?")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"secureな認証付きトークンを用いてpostする"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#secureな認証付きトークンを用いてpostする","aria-hidden":"true"}},[this._v("#")]),this._v(" secureな認証付きトークンを用いてPOSTする")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("後でやります(TODOに投げる)"),e("br"),this._v("\nDo better then perfectなので.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"最悪の対処法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#最悪の対処法","aria-hidden":"true"}},[this._v("#")]),this._v(" 最悪の対処法")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("app/controller/application_controller.rb")]),this._v("のCSRF対策のコードをコメントアウト."),e("br"),this._v("\n許せ...")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("$ curl -X POST -H 'Content-Type:application/json' 0.0.0.0:5000/api/tasks | jq")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v('{ "task":\n  {\n    "id": 7,\n    "name": "fuga",\n    "is_done": false,\n    "created_at": "2019-01-27T01:45:10.207Z",\n    "updated_at": "2019-01-27T01:45:10.207Z"\n  }\n}\n')])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("おkですね(全くおkではない)"),e("br"),this._v("\n後で認証は実装する.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"materializeの導入"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#materializeの導入","aria-hidden":"true"}},[this._v("#")]),this._v(" Materializeの導入")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("MaterializeというCSSフレームワークを導入する."),e("br"),this._v("\nGemを追加して"),e("code",[this._v("bundle install")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",[e("code",[this._v("Sprockets::FileNotFound")]),this._v("が出たら, Gemfileとかサーバの再起動とかしてみると直る.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v('// - app/assets/stylesheets/application.css\n// + app/assets/stylesheets/application.scss\n/* Materialize */\n\n@import "materialize/components/color-variables";\n$primary-color: color("teal", "accent-3") !default;\n$secondary-color: color("cyan", "base") !default;\n@import \'materialize\';\n@import \'material_icons\';\n')])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("// app/assets/javascripts/application.js\n//= require jquery\n//= require jquery.turbolinks\n//= require materialize-sprockets\n//= require turbolinks\n//= require_tree .\n\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"componentsを活用してヘッダを作成"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#componentsを活用してヘッダを作成","aria-hidden":"true"}},[this._v("#")]),this._v(" Componentsを活用してヘッダを作成")])}],!1,null,null,null);n.options.__file="vue_rails.md";e.default=n.exports}}]);